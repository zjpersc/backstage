/*! For license information please see 6ae54916.4eedcfbe.js.LICENSE.txt */
"use strict";(self.webpackChunkbackstage_microsite=self.webpackChunkbackstage_microsite||[]).push([[164613],{603905:(e,t,n)=>{n.d(t,{Zo:()=>u,kt:()=>g});var a=n(667294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var l=a.createContext({}),c=function(e){var t=a.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},u=function(e){var t=c(e.components);return a.createElement(l.Provider,{value:t},e.children)},p="mdxType",y={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},f=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,o=e.originalType,l=e.parentName,u=s(e,["components","mdxType","originalType","parentName"]),p=c(n),f=r,g=p["".concat(l,".").concat(f)]||p[f]||y[f]||o;return n?a.createElement(g,i(i({ref:t},u),{},{components:n})):a.createElement(g,i({ref:t},u))}));function g(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var o=n.length,i=new Array(o);i[0]=f;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s[p]="string"==typeof e?e:r,i[1]=s;for(var c=2;c<o;c++)i[c]=n[c];return a.createElement.apply(null,i)}return a.createElement.apply(null,n)}f.displayName="MDXCreateElement"},245354:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>c,contentTitle:()=>s,default:()=>y,frontMatter:()=>i,metadata:()=>l,toc:()=>u});n(827378);var a=n(603905);function r(){return r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},r.apply(this,arguments)}function o(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}const i={title:"FYI \ud83d\udce3 The Plugin Analytics API",author:"Eric Peterson, Spotify",authorURL:"https://github.com/iamEAP",authorImageURL:"https://avatars.githubusercontent.com/u/3496491?v=4"},s=void 0,l={permalink:"/blog/2022/09/08/fyi-plugin-analytics-api",source:"@site/../microsite/blog/2022-09-08-fyi-plugin-analytics-api.md",title:"FYI \ud83d\udce3 The Plugin Analytics API",description:"TL;DR If you didn't know, now you know: the Backstage plugin analytics API is here to help you understand how developers in your organization are using Backstage.",date:"2022-09-08T00:00:00.000Z",formattedDate:"September 8, 2022",tags:[],readingTime:3.215,hasTruncateMarker:!0,authors:[{name:"Eric Peterson, Spotify",url:"https://github.com/iamEAP",imageURL:"https://avatars.githubusercontent.com/u/3496491?v=4"}],frontMatter:{title:"FYI \ud83d\udce3 The Plugin Analytics API",author:"Eric Peterson, Spotify",authorURL:"https://github.com/iamEAP",authorImageURL:"https://avatars.githubusercontent.com/u/3496491?v=4"},prevItem:{title:"ICYMI: BackstageCon & KubeCon NA 2022 Recap",permalink:"/blog/2022/10/28/backstagecon-kubecon-2022"},nextItem:{title:"Backstage Security Audit & Updates",permalink:"/blog/2022/08/23/backstage-security-audit"}},c={authorsImageUrls:[void 0]},u=[{value:"What is the plugin analytics API?",id:"what-is-the-plugin-analytics-api",level:2},{value:"Start collecting data",id:"start-collecting-data",level:2},{value:"Instrument plugins",id:"instrument-plugins",level:2},{value:"Get involved",id:"get-involved",level:2}],p={toc:u};function y(e){var{components:t}=e,i=o(e,["components"]);return(0,a.kt)("wrapper",r({},p,i,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"TL;DR")," If you didn't know, now you know: the Backstage plugin analytics API is here to help you understand how developers in your organization are using Backstage."),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"The Plugin Analytics API",src:n(426941).Z,width:"1200",height:"630"})),(0,a.kt)("h2",r({},{id:"what-is-the-plugin-analytics-api"}),"What is the plugin analytics API?"),(0,a.kt)("p",null,"The plugin analytics API is a ",(0,a.kt)("a",r({parentName:"p"},{href:"https://backstage.io/docs/api/utility-apis"}),"utility api")," available by default in every Backstage instance, intended to bridge the gap between the needs of Backstage integrators and plugin developers. While Backstage integrators want visibility into the plugins they\u2019ve installed, they lack the power to instrument those plugins. And although plugin developers have the power to instrument plugins, they can\u2019t do so without a single, vendor-agnostic way to track events. Enter: the plugin analytics API."),(0,a.kt)("p",null,"While \u201canalytics\u201d as a concept can be broad, the goal of the API is narrowly focused: empower those deploying Backstage to understand usage of their instance. The plugin analytics API isn\u2019t designed to solve for observability use-cases like tracing, logging, performance monitoring, error metrics, or alerting. Rather, the API is designed to capture and quantify real user interactions, which can form the basis for metrics like daily active users, top plugins, and more."),(0,a.kt)("h2",r({},{id:"start-collecting-data"}),"Start collecting data"),(0,a.kt)("p",null,"Backstage core (and a few other plugins) are already instrumented with ",(0,a.kt)("a",r({parentName:"p"},{href:"https://backstage.io/docs/plugins/analytics#key-events"}),"key events")," that are ready for you to start collecting and analyzing."),(0,a.kt)("p",null,"The simplest way to get started is to use one of the ",(0,a.kt)("a",r({parentName:"p"},{href:"https://backstage.io/docs/plugins/analytics#supported-analytics-tools"}),"supported analytics tools")," and install its provided API implementation like you would any other utility API. For example:"),(0,a.kt)("pre",null,(0,a.kt)("code",r({parentName:"pre"},{className:"language-tsx"}),"// packages/app/src/apis.ts\nimport {\n  analyticsApiRef,\n  configApiRef,\n  identityApiRef,\n} from '@backstage/core-plugin-api';\nimport { GoogleAnalytics } from '@backstage/plugin-analytics-module-ga';\n\nexport const apis: AnyApiFactory[] = [\n  // Instantiate and register the GA Analytics API Implementation.\n  createApiFactory({\n    api: analyticsApiRef,\n    deps: { configApi: configApiRef, identityApi: identityApiRef },\n    factory: ({ configApi, identityApi }) =>\n      GoogleAnalytics.fromConfig(configApi, {\n        identityApi,\n      }),\n  }),\n];\n")),(0,a.kt)("p",null,"If your chosen analytics tool doesn\u2019t have an integration yet, you can write a custom integration by ",(0,a.kt)("a",r({parentName:"p"},{href:"https://backstage.io/docs/plugins/analytics#writing-integrations"}),"following these instructions"),". (And if you\u2019re integrating with a publicly available analytics service, as opposed to a custom in-house system, why not ",(0,a.kt)("a",r({parentName:"p"},{href:"https://backstage.io/docs/plugins/create-a-plugin"}),"consider contributing it back to the community"),"?)"),(0,a.kt)("h2",r({},{id:"instrument-plugins"}),"Instrument plugins"),(0,a.kt)("p",null,"While some key events are already instrumented, there may be important actions in open source plugins that are un-instrumented, not to mention in your custom, InnerSource plugins. Luckily, the plugin analytics API can be leveraged by open source and InnerSource plugins all the same."),(0,a.kt)("p",null,"To capture an event, invoke the ",(0,a.kt)("inlineCode",{parentName:"p"},"useAnalytics()")," react hook and call the function it returns when the user performs the action you wish to track (e.g. merging a pull request):"),(0,a.kt)("pre",null,(0,a.kt)("code",r({parentName:"pre"},{className:"language-tsx"}),"import { useAnalytics } from '@backstage/core-plugin-api';\n\nconst analytics = useAnalytics();\nanalytics.captureEvent('merge', pullRequestName);\n")),(0,a.kt)("p",null,"Don\u2019t worry about having to stuff additional levels of detail into just the event action and subject, you can provide extra dimensional data on the ",(0,a.kt)("inlineCode",{parentName:"p"},"attributes")," property, as well as a primary metric on the ",(0,a.kt)("inlineCode",{parentName:"p"},"value")," property, like this:"),(0,a.kt)("pre",null,(0,a.kt)("code",r({parentName:"pre"},{className:"language-tsx"}),"analytics.captureEvent('merge', pullRequestName, {\n  value: pullRequestAgeInMinutes,\n  attributes: {\n    org: orgName,\n    repo: repoName,\n  },\n});\n")),(0,a.kt)("p",null,"In situations where your plugin is tracking multiple events and you want all of those events to share common dimensional data, you can use the ",(0,a.kt)("inlineCode",{parentName:"p"},"<AnalyticsContext>"),". Every event captured in child components underneath this context automatically inherits the values you set:"),(0,a.kt)("pre",null,(0,a.kt)("code",r({parentName:"pre"},{className:"language-tsx"}),"import { AnalyticsContext } from '@backstage/core-plugin-api';\n\n<AnalyticsContext attributes={{ vcsProvider: 'github' }}>\n  {children}\n</AnalyticsContext\n")),(0,a.kt)("p",null,"In fact, Backstage core uses an ",(0,a.kt)("inlineCode",{parentName:"p"},"<AnalyticsContext>")," to automatically decorate every event with a corresponding plugin ID and an extension name in order to facilitate plugin-level analysis."),(0,a.kt)("p",null,"While the above should be enough to get you going, don\u2019t forget to check out ",(0,a.kt)("a",r({parentName:"p"},{href:"https://backstage.io/docs/plugins/analytics#capturing-events"}),"the complete guide to event capture"),", which covers event naming considerations, testing, and more."),(0,a.kt)("h2",r({},{id:"get-involved"}),"Get involved"),(0,a.kt)("p",null,"If you didn\u2019t know, now you know! If you\u2019re passionate about data and want to help push the Backstage analytics ecosystem forward, join us in the ",(0,a.kt)("a",r({parentName:"p"},{href:"https://discord.com/channels/687207715902193673/1007303347914690610"}),"#analytics channel on discord"),", contribute ",(0,a.kt)("a",r({parentName:"p"},{href:"https://github.com/backstage/backstage/issues/new?assignees=&labels=plugin&template=plugin_template.md&title=%5BAnalytics+Module%5D+THE+ANALYTICS+TOOL+TO+INTEGRATE"}),"integration ideas"),", or ",(0,a.kt)("a",r({parentName:"p"},{href:"https://github.com/backstage/backstage/issues/new?assignees=&labels=enhancement&template=feature_template.md&title=%5BAnalytics%20Event%5D:%20THE+EVENT+TO+CAPTURE"}),"suggest a new analytics event"),"."))}y.isMDXComponent=!0},426941:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/analytics-api-fyi-c26c23b9aae00e45ee0cf4a4661c806c.png"},862525:e=>{var t=Object.getOwnPropertySymbols,n=Object.prototype.hasOwnProperty,a=Object.prototype.propertyIsEnumerable;function r(e){if(null==e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}e.exports=function(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},n=0;n<10;n++)t["_"+String.fromCharCode(n)]=n;if("0123456789"!==Object.getOwnPropertyNames(t).map((function(e){return t[e]})).join(""))return!1;var a={};return"abcdefghijklmnopqrst".split("").forEach((function(e){a[e]=e})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},a)).join("")}catch(r){return!1}}()?Object.assign:function(e,o){for(var i,s,l=r(e),c=1;c<arguments.length;c++){for(var u in i=Object(arguments[c]))n.call(i,u)&&(l[u]=i[u]);if(t){s=t(i);for(var p=0;p<s.length;p++)a.call(i,s[p])&&(l[s[p]]=i[s[p]])}}return l}},541535:(e,t,n)=>{var a=n(862525),r=60103,o=60106;var i=60109,s=60110,l=60112;var c=60115,u=60116;if("function"==typeof Symbol&&Symbol.for){var p=Symbol.for;r=p("react.element"),o=p("react.portal"),p("react.fragment"),p("react.strict_mode"),p("react.profiler"),i=p("react.provider"),s=p("react.context"),l=p("react.forward_ref"),p("react.suspense"),c=p("react.memo"),u=p("react.lazy")}var y="function"==typeof Symbol&&Symbol.iterator;function f(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var g={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},h={};function d(e,t,n){this.props=e,this.context=t,this.refs=h,this.updater=n||g}function m(){}function v(e,t,n){this.props=e,this.context=t,this.refs=h,this.updater=n||g}d.prototype.isReactComponent={},d.prototype.setState=function(e,t){if("object"!=typeof e&&"function"!=typeof e&&null!=e)throw Error(f(85));this.updater.enqueueSetState(this,e,t,"setState")},d.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},m.prototype=d.prototype;var b=v.prototype=new m;b.constructor=v,a(b,d.prototype),b.isPureReactComponent=!0;var k={current:null},w=Object.prototype.hasOwnProperty,A={key:!0,ref:!0,__self:!0,__source:!0};function O(e,t,n){var a,o={},i=null,s=null;if(null!=t)for(a in void 0!==t.ref&&(s=t.ref),void 0!==t.key&&(i=""+t.key),t)w.call(t,a)&&!A.hasOwnProperty(a)&&(o[a]=t[a]);var l=arguments.length-2;if(1===l)o.children=n;else if(1<l){for(var c=Array(l),u=0;u<l;u++)c[u]=arguments[u+2];o.children=c}if(e&&e.defaultProps)for(a in l=e.defaultProps)void 0===o[a]&&(o[a]=l[a]);return{$$typeof:r,type:e,key:i,ref:s,props:o,_owner:k.current}}function j(e){return"object"==typeof e&&null!==e&&e.$$typeof===r}var P=/\/+/g;function I(e,t){return"object"==typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,(function(e){return t[e]}))}(""+e.key):t.toString(36)}function N(e,t,n,a,i){var s=typeof e;"undefined"!==s&&"boolean"!==s||(e=null);var l=!1;if(null===e)l=!0;else switch(s){case"string":case"number":l=!0;break;case"object":switch(e.$$typeof){case r:case o:l=!0}}if(l)return i=i(l=e),e=""===a?"."+I(l,0):a,Array.isArray(i)?(n="",null!=e&&(n=e.replace(P,"$&/")+"/"),N(i,t,n,"",(function(e){return e}))):null!=i&&(j(i)&&(i=function(e,t){return{$$typeof:r,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(i,n+(!i.key||l&&l.key===i.key?"":(""+i.key).replace(P,"$&/")+"/")+e)),t.push(i)),1;if(l=0,a=""===a?".":a+":",Array.isArray(e))for(var c=0;c<e.length;c++){var u=a+I(s=e[c],c);l+=N(s,t,n,u,i)}else if(u=function(e){return null===e||"object"!=typeof e?null:"function"==typeof(e=y&&e[y]||e["@@iterator"])?e:null}(e),"function"==typeof u)for(e=u.call(e),c=0;!(s=e.next()).done;)l+=N(s=s.value,t,n,u=a+I(s,c++),i);else if("object"===s)throw t=""+e,Error(f(31,"[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t));return l}function E(e,t,n){if(null==e)return e;var a=[],r=0;return N(e,a,"","",(function(e){return t.call(n,e,r++)})),a}function T(e){if(-1===e._status){var t=e._result;t=t(),e._status=0,e._result=t,t.then((function(t){0===e._status&&(t=t.default,e._status=1,e._result=t)}),(function(t){0===e._status&&(e._status=2,e._result=t)}))}if(1===e._status)return e._result;throw e._result}var S={current:null};function x(){var e=S.current;if(null===e)throw Error(f(321));return e}},827378:(e,t,n)=>{n(541535)}}]);