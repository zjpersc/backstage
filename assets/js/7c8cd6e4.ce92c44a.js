/*! For license information please see 7c8cd6e4.ce92c44a.js.LICENSE.txt */
"use strict";(self.webpackChunkbackstage_microsite=self.webpackChunkbackstage_microsite||[]).push([[363637],{603905:(t,e,r)=>{r.d(e,{Zo:()=>c,kt:()=>d});var n=r(667294);function a(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function o(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function i(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?o(Object(r),!0).forEach((function(e){a(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function s(t,e){if(null==t)return{};var r,n,a=function(t,e){if(null==t)return{};var r,n,a={},o=Object.keys(t);for(n=0;n<o.length;n++)r=o[n],e.indexOf(r)>=0||(a[r]=t[r]);return a}(t,e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(n=0;n<o.length;n++)r=o[n],e.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}var u=n.createContext({}),l=function(t){var e=n.useContext(u),r=e;return t&&(r="function"==typeof t?t(e):i(i({},e),t)),r},c=function(t){var e=l(t.components);return n.createElement(u.Provider,{value:e},t.children)},p="mdxType",f={inlineCode:"code",wrapper:function(t){var e=t.children;return n.createElement(n.Fragment,{},e)}},h=n.forwardRef((function(t,e){var r=t.components,a=t.mdxType,o=t.originalType,u=t.parentName,c=s(t,["components","mdxType","originalType","parentName"]),p=l(r),h=a,d=p["".concat(u,".").concat(h)]||p[h]||f[h]||o;return r?n.createElement(d,i(i({ref:e},c),{},{components:r})):n.createElement(d,i({ref:e},c))}));function d(t,e){var r=arguments,a=e&&e.mdxType;if("string"==typeof t||a){var o=r.length,i=new Array(o);i[0]=h;var s={};for(var u in e)hasOwnProperty.call(e,u)&&(s[u]=e[u]);s.originalType=t,s[p]="string"==typeof t?t:a,i[1]=s;for(var l=2;l<o;l++)i[l]=r[l];return n.createElement.apply(null,i)}return n.createElement.apply(null,r)}h.displayName="MDXCreateElement"},808831:(t,e,r)=>{r.r(e),r.d(e,{assets:()=>l,contentTitle:()=>s,default:()=>f,frontMatter:()=>i,metadata:()=>u,toc:()=>c});r(827378);var n=r(603905);function a(){return a=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},a.apply(this,arguments)}function o(t,e){if(null==t)return{};var r,n,a=function(t,e){if(null==t)return{};var r,n,a={},o=Object.keys(t);for(n=0;n<o.length;n++)r=o[n],e.indexOf(r)>=0||(a[r]=t[r]);return a}(t,e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(n=0;n<o.length;n++)r=o[n],e.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}const i={title:"How to enable authentication in Backstage using Passport",author:"Lee Mills, Spotify",authorURL:"https://github.com/leemills83",authorImageURL:"https://avatars1.githubusercontent.com/u/1236238?s=460&v=4"},s=void 0,u={permalink:"/blog/2020/07/01/how-to-enable-authentication-in-backstage-using-passport",source:"@site/../microsite/blog/2020-07-01-how-to-enable-authentication-in-backstage-using-passport.md",title:"How to enable authentication in Backstage using Passport",description:"auth-landing-page",date:"2020-07-01T00:00:00.000Z",formattedDate:"July 1, 2020",tags:[],readingTime:2.01,hasTruncateMarker:!0,authors:[{name:"Lee Mills, Spotify",url:"https://github.com/leemills83",imageURL:"https://avatars1.githubusercontent.com/u/1236238?s=460&v=4"}],frontMatter:{title:"How to enable authentication in Backstage using Passport",author:"Lee Mills, Spotify",authorURL:"https://github.com/leemills83",authorImageURL:"https://avatars1.githubusercontent.com/u/1236238?s=460&v=4"},prevItem:{title:"Announcing Backstage Software Templates",permalink:"/blog/2020/08/05/announcing-backstage-software-templates"},nextItem:{title:"Backstage Service Catalog released in alpha",permalink:"/blog/2020/06/22/backstage-service-catalog-alpha"}},l={authorsImageUrls:[void 0]},c=[{value:"What is Passport?",id:"what-is-passport",level:2},{value:"Using authentication in Backstage",id:"using-authentication-in-backstage",level:2},{value:"Ready to get started by adding your chosen provider and implementation?",id:"ready-to-get-started-by-adding-your-chosen-provider-and-implementation",level:2},{value:"Interested in contributing to the next steps for authentication?",id:"interested-in-contributing-to-the-next-steps-for-authentication",level:2}],p={toc:c};function f(t){var{components:e}=t,i=o(t,["components"]);return(0,n.kt)("wrapper",a({},p,i,{components:e,mdxType:"MDXLayout"}),(0,n.kt)("p",null,(0,n.kt)("img",{alt:"auth-landing-page",src:r(789857).Z,width:"1548",height:"622"})),(0,n.kt)("p",null,"Getting authentication right is important. It helps keep your platform safe, it\u2019s one of the first things users will interact with, and there are many different authentication providers to support. To this end, we chose to use ",(0,n.kt)("a",a({parentName:"p"},{href:"http://www.passportjs.org/"}),"Passport")," to provide an easy-to-use, out-of-the-box experience that can be extended to your own, pre-existing authentication providers (known as strategies). The Auth APIs in Backstage serve two purposes: identify the user and provide a way for plugins to request access to third-party services on behalf of the user. We\u2019ve already implemented Google and GitHub authentication to provide examples and to get you started."),(0,n.kt)("h2",a({},{id:"what-is-passport"}),"What is Passport?"),(0,n.kt)("p",null,(0,n.kt)("a",a({parentName:"p"},{href:"http://www.passportjs.org/"}),"Passport")," is Express-compatible authentication middleware for Node.js that provides access to over 500 authentication providers, covering everything from Google, Facebook, and Twitter to generic OAuth, SAML, and local. Check out all of the currently available ",(0,n.kt)("a",a({parentName:"p"},{href:"http://www.passportjs.org/"}),"strategies listed on the Passport site"),"."),(0,n.kt)("p",null,"Passport has allowed us to leverage an existing open-source authentication framework that will, in turn, give users the freedom to add and extend alternative authentication strategies to their instance of Backstage."),(0,n.kt)("h2",a({},{id:"using-authentication-in-backstage"}),"Using authentication in Backstage"),(0,n.kt)("p",null,(0,n.kt)("img",{alt:"auth-landing-page",src:r(833261).Z,width:"206",height:"185"})),(0,n.kt)("p",null,"First, check out the provided Google and GitHub implementations! ",(0,n.kt)("a",a({parentName:"p"},{href:"https://backstage.io/blog/2020/04/30/how-to-quickly-set-up-backstage"}),"Spin up a local copy of Backstage")," along with our example-backend. You can find more documentation on setting up the example backend ",(0,n.kt)("a",a({parentName:"p"},{href:"https://github.com/backstage/backstage/tree/master/packages/backend"}),"here"),", but be sure to include the relevant client IDs and secrets when running ",(0,n.kt)("inlineCode",{parentName:"p"},"yarn start"),":"),(0,n.kt)("pre",null,(0,n.kt)("code",a({parentName:"pre"},{}),"AUTH_GOOGLE_CLIENT_ID=x AUTH_GOOGLE_CLIENT_SECRET=x AUTH_GITHUB_CLIENT_ID=x AUTH_GITHUB_CLIENT_SECRET=x SENTRY_TOKEN=x LOG_LEVEL=debug yarn start\n")),(0,n.kt)("p",null,"You can find the implementation for these strategies along with a lightweight proof-of-concept implementation for SAML authentication at ",(0,n.kt)("inlineCode",{parentName:"p"},"<root>/plugins/auth-backend/src/providers"),"."),(0,n.kt)("h2",a({},{id:"ready-to-get-started-by-adding-your-chosen-provider-and-implementation"}),"Ready to get started by adding your chosen provider and implementation?"),(0,n.kt)("p",null,"Getting started is really straightforward, and can be broadly broken down into five steps:"),(0,n.kt)("ol",null,(0,n.kt)("li",{parentName:"ol"},"Install the ",(0,n.kt)("a",a({parentName:"li"},{href:"http://www.passportjs.org/"}),"Passport-based provider package that best suits your needs"),"."),(0,n.kt)("li",{parentName:"ol"},"Add a new provider to ",(0,n.kt)("inlineCode",{parentName:"li"},"plugins/auth-backend/src/providers/")),(0,n.kt)("li",{parentName:"ol"},"Implement the provider, extending the suitable framework, if needed."),(0,n.kt)("li",{parentName:"ol"},"Add the provider to the backend."),(0,n.kt)("li",{parentName:"ol"},"Add a frontend Auth Utility API.")),(0,n.kt)("p",null,"For full details, take a look at our ",(0,n.kt)("a",a({parentName:"p"},{href:"/docs/auth/add-auth-provider"}),"\u201cAdding authentication providers\u201d documentation")," and at the ",(0,n.kt)("a",a({parentName:"p"},{href:"http://www.passportjs.org/docs/"}),"excellent documentation")," provided by Passport."),(0,n.kt)("h2",a({},{id:"interested-in-contributing-to-the-next-steps-for-authentication"}),"Interested in contributing to the next steps for authentication?"),(0,n.kt)("p",null,"We\u2019ve already seen both GitLab and Okta contributions from the community \u2014 and we\u2019re thinking about a few more providers we\u2019d like to add to Backstage, too. You can find those, and other authentication-related issues, in our repository by filtering with the ",(0,n.kt)("a",a({parentName:"p"},{href:"https://github.com/backstage/backstage/issues?q=is%3Aissue+is%3Aopen+label%3Aauth"}),"auth label"),"."))}f.isMDXComponent=!0},789857:(t,e,r)=>{r.d(e,{Z:()=>n});const n=r.p+"assets/images/auth-landing-36c55882496255abe67830e1ea6db2ea.png"},833261:(t,e,r)=>{r.d(e,{Z:()=>n});const n=r.p+"assets/images/auth-sidebar-7757b6f66cada94c378abb527b01859a.png"},862525:t=>{var e=Object.getOwnPropertySymbols,r=Object.prototype.hasOwnProperty,n=Object.prototype.propertyIsEnumerable;function a(t){if(null==t)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(t)}t.exports=function(){try{if(!Object.assign)return!1;var t=new String("abc");if(t[5]="de","5"===Object.getOwnPropertyNames(t)[0])return!1;for(var e={},r=0;r<10;r++)e["_"+String.fromCharCode(r)]=r;if("0123456789"!==Object.getOwnPropertyNames(e).map((function(t){return e[t]})).join(""))return!1;var n={};return"abcdefghijklmnopqrst".split("").forEach((function(t){n[t]=t})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},n)).join("")}catch(a){return!1}}()?Object.assign:function(t,o){for(var i,s,u=a(t),l=1;l<arguments.length;l++){for(var c in i=Object(arguments[l]))r.call(i,c)&&(u[c]=i[c]);if(e){s=e(i);for(var p=0;p<s.length;p++)n.call(i,s[p])&&(u[s[p]]=i[s[p]])}}return u}},541535:(t,e,r)=>{var n=r(862525),a=60103,o=60106;var i=60109,s=60110,u=60112;var l=60115,c=60116;if("function"==typeof Symbol&&Symbol.for){var p=Symbol.for;a=p("react.element"),o=p("react.portal"),p("react.fragment"),p("react.strict_mode"),p("react.profiler"),i=p("react.provider"),s=p("react.context"),u=p("react.forward_ref"),p("react.suspense"),l=p("react.memo"),c=p("react.lazy")}var f="function"==typeof Symbol&&Symbol.iterator;function h(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,r=1;r<arguments.length;r++)e+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var d={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},g={};function b(t,e,r){this.props=t,this.context=e,this.refs=g,this.updater=r||d}function m(){}function y(t,e,r){this.props=t,this.context=e,this.refs=g,this.updater=r||d}b.prototype.isReactComponent={},b.prototype.setState=function(t,e){if("object"!=typeof t&&"function"!=typeof t&&null!=t)throw Error(h(85));this.updater.enqueueSetState(this,t,e,"setState")},b.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")},m.prototype=b.prototype;var v=y.prototype=new m;v.constructor=y,n(v,b.prototype),v.isPureReactComponent=!0;var k={current:null},w=Object.prototype.hasOwnProperty,O={key:!0,ref:!0,__self:!0,__source:!0};function j(t,e,r){var n,o={},i=null,s=null;if(null!=e)for(n in void 0!==e.ref&&(s=e.ref),void 0!==e.key&&(i=""+e.key),e)w.call(e,n)&&!O.hasOwnProperty(n)&&(o[n]=e[n]);var u=arguments.length-2;if(1===u)o.children=r;else if(1<u){for(var l=Array(u),c=0;c<u;c++)l[c]=arguments[c+2];o.children=l}if(t&&t.defaultProps)for(n in u=t.defaultProps)void 0===o[n]&&(o[n]=u[n]);return{$$typeof:a,type:t,key:i,ref:s,props:o,_owner:k.current}}function _(t){return"object"==typeof t&&null!==t&&t.$$typeof===a}var x=/\/+/g;function P(t,e){return"object"==typeof t&&null!==t&&null!=t.key?function(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,(function(t){return e[t]}))}(""+t.key):e.toString(36)}function S(t,e,r,n,i){var s=typeof t;"undefined"!==s&&"boolean"!==s||(t=null);var u=!1;if(null===t)u=!0;else switch(s){case"string":case"number":u=!0;break;case"object":switch(t.$$typeof){case a:case o:u=!0}}if(u)return i=i(u=t),t=""===n?"."+P(u,0):n,Array.isArray(i)?(r="",null!=t&&(r=t.replace(x,"$&/")+"/"),S(i,e,r,"",(function(t){return t}))):null!=i&&(_(i)&&(i=function(t,e){return{$$typeof:a,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}(i,r+(!i.key||u&&u.key===i.key?"":(""+i.key).replace(x,"$&/")+"/")+t)),e.push(i)),1;if(u=0,n=""===n?".":n+":",Array.isArray(t))for(var l=0;l<t.length;l++){var c=n+P(s=t[l],l);u+=S(s,e,r,c,i)}else if(c=function(t){return null===t||"object"!=typeof t?null:"function"==typeof(t=f&&t[f]||t["@@iterator"])?t:null}(t),"function"==typeof c)for(t=c.call(t),l=0;!(s=t.next()).done;)u+=S(s=s.value,e,r,c=n+P(s,l++),i);else if("object"===s)throw e=""+t,Error(h(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e));return u}function E(t,e,r){if(null==t)return t;var n=[],a=0;return S(t,n,"","",(function(t){return e.call(r,t,a++)})),n}function T(t){if(-1===t._status){var e=t._result;e=e(),t._status=0,t._result=e,e.then((function(e){0===t._status&&(e=e.default,t._status=1,t._result=e)}),(function(e){0===t._status&&(t._status=2,t._result=e)}))}if(1===t._status)return t._result;throw t._result}var N={current:null};function A(){var t=N.current;if(null===t)throw Error(h(321));return t}},827378:(t,e,r)=>{r(541535)}}]);