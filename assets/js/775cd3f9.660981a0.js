/*! For license information please see 775cd3f9.660981a0.js.LICENSE.txt */
"use strict";(self.webpackChunkbackstage_microsite=self.webpackChunkbackstage_microsite||[]).push([[955211],{603905:(e,t,n)=>{n.d(t,{Zo:()=>c,kt:()=>f});var r=n(667294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var u=r.createContext({}),l=function(e){var t=r.useContext(u),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},c=function(e){var t=l(e.components);return r.createElement(u.Provider,{value:t},e.children)},p="mdxType",d={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},g=r.forwardRef((function(e,t){var n=e.components,a=e.mdxType,o=e.originalType,u=e.parentName,c=s(e,["components","mdxType","originalType","parentName"]),p=l(n),g=a,f=p["".concat(u,".").concat(g)]||p[g]||d[g]||o;return n?r.createElement(f,i(i({ref:t},c),{},{components:n})):r.createElement(f,i({ref:t},c))}));function f(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var o=n.length,i=new Array(o);i[0]=g;var s={};for(var u in t)hasOwnProperty.call(t,u)&&(s[u]=t[u]);s.originalType=e,s[p]="string"==typeof e?e:a,i[1]=s;for(var l=2;l<o;l++)i[l]=n[l];return r.createElement.apply(null,i)}return r.createElement.apply(null,n)}g.displayName="MDXCreateElement"},144977:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>s,default:()=>d,frontMatter:()=>i,metadata:()=>u,toc:()=>c});n(827378);var r=n(603905);function a(){return a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},a.apply(this,arguments)}function o(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}const i={id:"org",title:"GitHub Organizational Data",sidebar_label:"Org Data",description:"Importing users and groups from a GitHub organization into Backstage"},s=void 0,u={unversionedId:"integrations/github/org",id:"integrations/github/org",title:"GitHub Organizational Data",description:"Importing users and groups from a GitHub organization into Backstage",source:"@site/../docs/integrations/github/org.md",sourceDirName:"integrations/github",slug:"/integrations/github/org",permalink:"/docs/integrations/github/org",draft:!1,editUrl:"https://github.com/backstage/backstage/edit/master/docs/../docs/integrations/github/org.md",tags:[],version:"current",frontMatter:{id:"org",title:"GitHub Organizational Data",sidebar_label:"Org Data",description:"Importing users and groups from a GitHub organization into Backstage"},sidebar:"docs",previous:{title:"Discovery",permalink:"/docs/integrations/github/discovery"},next:{title:"GitHub Apps",permalink:"/docs/integrations/github/github-apps"}},l={},c=[{value:"Installation without Events Support",id:"installation-without-events-support",level:2},{value:"Installation with Events Support",id:"installation-with-events-support",level:2},{value:"Configuration",id:"configuration",level:2},{value:"Custom Transformers",id:"custom-transformers",level:3},{value:"Resolving GitHub users via organization email",id:"resolving-github-users-via-organization-email",level:3},{value:"Using a Processor instead of a Provider",id:"using-a-processor-instead-of-a-provider",level:2},{value:"Processor Installation",id:"processor-installation",level:3},{value:"Processor Configuration",id:"processor-configuration",level:3}],p={toc:c};function d(e){var{components:t}=e,i=o(e,["components"]);return(0,r.kt)("wrapper",a({},p,i,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("p",null,"The Backstage catalog can be set up to ingest organizational data - users and\nteams - directly from an organization in GitHub or GitHub Enterprise. The result\nis a hierarchy of\n",(0,r.kt)("a",a({parentName:"p"},{href:"/docs/features/software-catalog/descriptor-format#kind-user"}),(0,r.kt)("inlineCode",{parentName:"a"},"User"))," and\n",(0,r.kt)("a",a({parentName:"p"},{href:"/docs/features/software-catalog/descriptor-format#kind-group"}),(0,r.kt)("inlineCode",{parentName:"a"},"Group"))," kind\nentities that mirror your org setup."),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"Note: This adds ",(0,r.kt)("inlineCode",{parentName:"p"},"User")," and ",(0,r.kt)("inlineCode",{parentName:"p"},"Group")," entities to the catalog, but does not\nprovide authentication. See the\n",(0,r.kt)("a",a({parentName:"p"},{href:"/docs/auth/github/provider"}),"GitHub auth provider")," for that.")),(0,r.kt)("h2",a({},{id:"installation-without-events-support"}),"Installation without Events Support"),(0,r.kt)("p",null,"This guide will use the Entity Provider method. If you for some reason prefer\nthe Processor method (not recommended), it is described separately below."),(0,r.kt)("p",null,"The provider is not installed by default, therefore you have to add a dependency\nto ",(0,r.kt)("inlineCode",{parentName:"p"},"@backstage/plugin-catalog-backend-module-github")," to your backend package."),(0,r.kt)("pre",null,(0,r.kt)("code",a({parentName:"pre"},{className:"language-bash"}),"# From your Backstage root directory\nyarn add --cwd packages/backend @backstage/plugin-catalog-backend-module-github\n")),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"Note: When configuring to use a Provider instead of a Processor you do not\nneed to add a ",(0,r.kt)("em",{parentName:"p"},"location")," pointing to your GitHub server/organization")),(0,r.kt)("p",null,"Update the catalog plugin initialization in your backend to add the provider and\nschedule it:"),(0,r.kt)("pre",null,(0,r.kt)("code",a({parentName:"pre"},{className:"language-diff"})," // packages/backend/src/plugins/catalog.ts\n+import { GithubOrgEntityProvider } from '@backstage/plugin-catalog-backend-module-github';\n\n export default async function createPlugin(\n   env: PluginEnvironment,\n ): Promise<Router> {\n   const builder = await CatalogBuilder.create(env);\n\n+  // The org URL below needs to match a configured integrations.github entry\n+  // specified in your app-config.\n+  builder.addEntityProvider(\n+    GithubOrgEntityProvider.fromConfig(env.config, {\n+      id: 'production',\n+      orgUrl: 'https://github.com/backstage',\n+      logger: env.logger,\n+      schedule: env.scheduler.createScheduledTaskRunner({\n+        frequency: { minutes: 60 },\n+        timeout: { minutes: 15 },\n+      }),\n+    }),\n+  );\n")),(0,r.kt)("h2",a({},{id:"installation-with-events-support"}),"Installation with Events Support"),(0,r.kt)("p",null,"Please follow the installation instructions at"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",a({parentName:"li"},{href:"https://github.com/backstage/backstage/tree/master/plugins/events-backend/README.md"}),"https://github.com/backstage/backstage/tree/master/plugins/events-backend/README.md")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",a({parentName:"li"},{href:"https://github.com/backstage/backstage/tree/master/plugins/events-backend-module-github/README.md"}),"https://github.com/backstage/backstage/tree/master/plugins/events-backend-module-github/README.md"))),(0,r.kt)("p",null,"Additionally, you need to decide how you want to receive events from external sources like"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",a({parentName:"li"},{href:"https://github.com/backstage/backstage/tree/master/plugins/events-backend/README.md"}),"via HTTP endpoint")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",a({parentName:"li"},{href:"https://github.com/backstage/backstage/tree/master/plugins/events-backend-module-aws-sqs/README.md"}),"via an AWS SQS queue"))),(0,r.kt)("p",null,"Set up your provider"),(0,r.kt)("pre",null,(0,r.kt)("code",a({parentName:"pre"},{className:"language-diff"}),"// packages/backend/src/plugins/catalogEventBasedProviders.ts\n+import { GithubOrgEntityProvider } from '@backstage/plugin-catalog-backend-module-github';\n import { EntityProvider } from '@backstage/plugin-catalog-node';\n import { EventSubscriber } from '@backstage/plugin-events-node';\n import { PluginEnvironment } from '../types';\n export default async function createCatalogEventBasedProviders(\n-  _: PluginEnvironment,\n+  env: PluginEnvironment,\n ): Promise<Array<EntityProvider & EventSubscriber>> {\n   const providers: Array<\n     (EntityProvider & EventSubscriber) | Array<EntityProvider & EventSubscriber>\n   > = [];\n-  // add your event-based entity providers here\n+  providers.push(\n+    GithubOrgEntityProvider.fromConfig(env.config, {\n+      id: 'production',\n+      orgUrl: 'https://github.com/backstage',\n+      logger: env.logger,\n+      schedule: env.scheduler.createScheduledTaskRunner({\n+        frequency: { minutes: 60 },\n+        timeout: { minutes: 15 },\n+      }),\n+    }),\n+  );\n   return providers.flat();\n }\n")),(0,r.kt)("p",null,"You can check the official docs to ",(0,r.kt)("a",a({parentName:"p"},{href:"https://docs.github.com/en/developers/webhooks-and-events/webhooks/creating-webhooks"}),"configure your webhook")," and to ",(0,r.kt)("a",a({parentName:"p"},{href:"https://docs.github.com/en/developers/webhooks-and-events/webhooks/securing-your-webhooks"}),"secure your request"),".\nThe webhook will need to be configured to forward ",(0,r.kt)("inlineCode",{parentName:"p"},"organization"),",",(0,r.kt)("inlineCode",{parentName:"p"},"team")," and ",(0,r.kt)("inlineCode",{parentName:"p"},"membership")," events."),(0,r.kt)("h2",a({},{id:"configuration"}),"Configuration"),(0,r.kt)("p",null,"As mentioned above, you also must have some configuration in your app-config\nthat describes the targets that you want to import. This lets the entity\nprovider know what authorization to use, and what the API endpoints are. You may\nor may not have such an entry already added since before:"),(0,r.kt)("pre",null,(0,r.kt)("code",a({parentName:"pre"},{className:"language-yaml"}),"integrations:\n  github:\n    # example for public github\n    - host: github.com\n      token: ${GITHUB_TOKEN}\n    # example for a private GitHub Enterprise instance\n    - host: ghe.example.net\n      apiBaseUrl: https://ghe.example.net/api/v3\n      token: ${GHE_TOKEN}\n")),(0,r.kt)("p",null,"These examples use ",(0,r.kt)("inlineCode",{parentName:"p"},"${}")," placeholders to reference environment variables. This\nis often suitable for production setups, but also means that you will have to\nsupply those variables to the backend as it starts up. If you want, for local\ndevelopment in particular, you can experiment first by putting the actual tokens\nin a mirrored config directly in your ",(0,r.kt)("inlineCode",{parentName:"p"},"app-config.local.yaml")," as well."),(0,r.kt)("p",null,"If Backstage is configured to use GitHub Apps authentication you must grant\n",(0,r.kt)("inlineCode",{parentName:"p"},"Read-Only")," access for ",(0,r.kt)("inlineCode",{parentName:"p"},"Members")," under ",(0,r.kt)("inlineCode",{parentName:"p"},"Organization")," in order to ingest users\ncorrectly. You can modify the app's permissions under the organization settings,\n",(0,r.kt)("inlineCode",{parentName:"p"},"https://github.com/organizations/{ORG}/settings/apps/{APP_NAME}/permissions"),"."),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"permissions",src:n(72859).Z,width:"1534",height:"324"})),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Please note that when you change permissions, the app owner will get an email\nthat must be approved first before the changes are applied.")),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"email",src:n(620077).Z,width:"1262",height:"732"})),(0,r.kt)("h3",a({},{id:"custom-transformers"}),"Custom Transformers"),(0,r.kt)("p",null,"You can inject your own transformation logic to help map from GH API responses\ninto backstage entities. You can do this on the user and team requests to\nenable you to do further processing or updates to the entities."),(0,r.kt)("p",null,"To enable this you pass a function into the ",(0,r.kt)("inlineCode",{parentName:"p"},"GitHubOrgEntityProvider"),". You can\npass a ",(0,r.kt)("inlineCode",{parentName:"p"},"UserTransformer"),", ",(0,r.kt)("inlineCode",{parentName:"p"},"TeamTransformer")," or both. The function is invoked\nfor each item (user or team) that is returned from the API. You can either\nreturn an Entity (User or Group) or ",(0,r.kt)("inlineCode",{parentName:"p"},"undefined")," if you do not want to import\nthat item."),(0,r.kt)("p",null,"There is also a ",(0,r.kt)("inlineCode",{parentName:"p"},"defaultUserTransformer")," and ",(0,r.kt)("inlineCode",{parentName:"p"},"defaultOrganizationTeamTransformer"),".\nYou could use these and simply decorate the response from the default\ntransformation if you only need to change a few properties."),(0,r.kt)("h3",a({},{id:"resolving-github-users-via-organization-email"}),"Resolving GitHub users via organization email"),(0,r.kt)("p",null,"When you authenticate users you should resolve them to an entity within the\ncatalog. Often the authentication you use could be a corporate SSO system that\nprovides you with email as a key. To enable you to find and resolve GitHub users\nit's useful to also import the private domain verified emails into the User\nentity in backstage."),(0,r.kt)("p",null,"The integration attempts to return ",(0,r.kt)("inlineCode",{parentName:"p"},"organizationVerifiedDomainEmails")," from the\nGitHub API and makes this available as part of the object passed to\n",(0,r.kt)("inlineCode",{parentName:"p"},"UserTransformer"),". The GitHub API will only return emails that use a domain\nthat's a verified domain for your GitHub Org. It also relies on the user having\nconfigured such an email in their own account. The API will only return these\nvalues when using GitHub App authentication and with the correct app permission\nallowing access to emails."),(0,r.kt)("p",null,"You can decorate the ",(0,r.kt)("inlineCode",{parentName:"p"},"defaultUserTransformer")," to replace the org email in the\nreturned identity."),(0,r.kt)("pre",null,(0,r.kt)("code",a({parentName:"pre"},{className:"language-typescript"}),"async (user, ctx): Promise<UserEntity | undefined> => {\n  const entity = await defaultUserTransformer(user, ctx);\n\n  if (entity && user.organizationVerifiedDomainEmails) {\n    entity.spec.profile!.email = user.organizationVerifiedDomainEmails[0] || '';\n  }\n\n  return entity;\n},\n")),(0,r.kt)("p",null,"Once you have imported the emails you can resolve users in your sign-in in\nresolver using the catalog entity search via email"),(0,r.kt)("pre",null,(0,r.kt)("code",a({parentName:"pre"},{className:"language-typescript"}),"// packages/backend/src/plugins/auth.ts\nctx.signInWithCatalogUser({\n  filter: {\n    kind: ['User'],\n    'spec.profile.email': email as string,\n  },\n});\n")),(0,r.kt)("h2",a({},{id:"using-a-processor-instead-of-a-provider"}),"Using a Processor instead of a Provider"),(0,r.kt)("p",null,"An alternative to using the Provider for ingesting organizational entities is to\nuse a Processor. This is the old way that's based on registering locations with\nthe proper type and target, triggering the processor to run."),(0,r.kt)("p",null,"The drawback of this method is that it will leave orphaned Group/User entities\nwhenever they are deleted on your GitHub server, and you cannot control the\nfrequency with which they are refreshed, separately from other processors."),(0,r.kt)("h3",a({},{id:"processor-installation"}),"Processor Installation"),(0,r.kt)("p",null,"The ",(0,r.kt)("inlineCode",{parentName:"p"},"GithubOrgReaderProcessor")," is not registered by default, so you have to\ninstall and register it in the catalog plugin:"),(0,r.kt)("pre",null,(0,r.kt)("code",a({parentName:"pre"},{className:"language-bash"}),"# From your Backstage root directory\nyarn add --cwd packages/backend @backstage/plugin-catalog-backend-module-github\n")),(0,r.kt)("pre",null,(0,r.kt)("code",a({parentName:"pre"},{className:"language-typescript"}),"// packages/backend/src/plugins/catalog.ts\nimport { GithubOrgReaderProcessor } from '@backstage/plugin-catalog-backend-module-github';\n// ...\nbuilder.addProcessor(\n  GithubOrgReaderProcessor.fromConfig(env.config, { logger: env.logger }),\n);\n")),(0,r.kt)("h3",a({},{id:"processor-configuration"}),"Processor Configuration"),(0,r.kt)("p",null,"The integration section of your app-config needs to be set up in the same way as\nfor the Entity Provider - see above."),(0,r.kt)("p",null,"In addition to that, you typically want to add a few static locations to your\napp-config, which reference your organizations to import. The following\nconfiguration enables an import of the teams and users under the org\n",(0,r.kt)("inlineCode",{parentName:"p"},"https://github.com/my-org-name")," on public GitHub."),(0,r.kt)("pre",null,(0,r.kt)("code",a({parentName:"pre"},{className:"language-yaml"}),"catalog:\n  locations:\n    - type: github-org\n      target: https://github.com/my-org-name\n      rules:\n        - allow: [User, Group]\n")))}d.isMDXComponent=!0},620077:(e,t,n)=>{n.d(t,{Z:()=>r});const r=n.p+"assets/images/email-d5628d6813a978b367112f533ff20242.png"},72859:(e,t,n)=>{n.d(t,{Z:()=>r});const r=n.p+"assets/images/permissions-a2f1b6967d5d744368b60016dfba17ba.png"},862525:e=>{var t=Object.getOwnPropertySymbols,n=Object.prototype.hasOwnProperty,r=Object.prototype.propertyIsEnumerable;function a(e){if(null==e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}e.exports=function(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},n=0;n<10;n++)t["_"+String.fromCharCode(n)]=n;if("0123456789"!==Object.getOwnPropertyNames(t).map((function(e){return t[e]})).join(""))return!1;var r={};return"abcdefghijklmnopqrst".split("").forEach((function(e){r[e]=e})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},r)).join("")}catch(a){return!1}}()?Object.assign:function(e,o){for(var i,s,u=a(e),l=1;l<arguments.length;l++){for(var c in i=Object(arguments[l]))n.call(i,c)&&(u[c]=i[c]);if(t){s=t(i);for(var p=0;p<s.length;p++)r.call(i,s[p])&&(u[s[p]]=i[s[p]])}}return u}},541535:(e,t,n)=>{var r=n(862525),a=60103,o=60106;var i=60109,s=60110,u=60112;var l=60115,c=60116;if("function"==typeof Symbol&&Symbol.for){var p=Symbol.for;a=p("react.element"),o=p("react.portal"),p("react.fragment"),p("react.strict_mode"),p("react.profiler"),i=p("react.provider"),s=p("react.context"),u=p("react.forward_ref"),p("react.suspense"),l=p("react.memo"),c=p("react.lazy")}var d="function"==typeof Symbol&&Symbol.iterator;function g(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var f={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},h={};function m(e,t,n){this.props=e,this.context=t,this.refs=h,this.updater=n||f}function b(){}function y(e,t,n){this.props=e,this.context=t,this.refs=h,this.updater=n||f}m.prototype.isReactComponent={},m.prototype.setState=function(e,t){if("object"!=typeof e&&"function"!=typeof e&&null!=e)throw Error(g(85));this.updater.enqueueSetState(this,e,t,"setState")},m.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},b.prototype=m.prototype;var k=y.prototype=new b;k.constructor=y,r(k,m.prototype),k.isPureReactComponent=!0;var v={current:null},w=Object.prototype.hasOwnProperty,O={key:!0,ref:!0,__self:!0,__source:!0};function P(e,t,n){var r,o={},i=null,s=null;if(null!=t)for(r in void 0!==t.ref&&(s=t.ref),void 0!==t.key&&(i=""+t.key),t)w.call(t,r)&&!O.hasOwnProperty(r)&&(o[r]=t[r]);var u=arguments.length-2;if(1===u)o.children=n;else if(1<u){for(var l=Array(u),c=0;c<u;c++)l[c]=arguments[c+2];o.children=l}if(e&&e.defaultProps)for(r in u=e.defaultProps)void 0===o[r]&&(o[r]=u[r]);return{$$typeof:a,type:e,key:i,ref:s,props:o,_owner:v.current}}function N(e){return"object"==typeof e&&null!==e&&e.$$typeof===a}var E=/\/+/g;function j(e,t){return"object"==typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,(function(e){return t[e]}))}(""+e.key):t.toString(36)}function T(e,t,n,r,i){var s=typeof e;"undefined"!==s&&"boolean"!==s||(e=null);var u=!1;if(null===e)u=!0;else switch(s){case"string":case"number":u=!0;break;case"object":switch(e.$$typeof){case a:case o:u=!0}}if(u)return i=i(u=e),e=""===r?"."+j(u,0):r,Array.isArray(i)?(n="",null!=e&&(n=e.replace(E,"$&/")+"/"),T(i,t,n,"",(function(e){return e}))):null!=i&&(N(i)&&(i=function(e,t){return{$$typeof:a,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(i,n+(!i.key||u&&u.key===i.key?"":(""+i.key).replace(E,"$&/")+"/")+e)),t.push(i)),1;if(u=0,r=""===r?".":r+":",Array.isArray(e))for(var l=0;l<e.length;l++){var c=r+j(s=e[l],l);u+=T(s,t,n,c,i)}else if(c=function(e){return null===e||"object"!=typeof e?null:"function"==typeof(e=d&&e[d]||e["@@iterator"])?e:null}(e),"function"==typeof c)for(e=c.call(e),l=0;!(s=e.next()).done;)u+=T(s=s.value,t,n,c=r+j(s,l++),i);else if("object"===s)throw t=""+e,Error(g(31,"[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t));return u}function C(e,t,n){if(null==e)return e;var r=[],a=0;return T(e,r,"","",(function(e){return t.call(n,e,a++)})),r}function G(e){if(-1===e._status){var t=e._result;t=t(),e._status=0,e._result=t,t.then((function(t){0===e._status&&(t=t.default,e._status=1,e._result=t)}),(function(t){0===e._status&&(e._status=2,e._result=t)}))}if(1===e._status)return e._result;throw e._result}var S={current:null};function _(){var e=S.current;if(null===e)throw Error(g(321));return e}},827378:(e,t,n)=>{n(541535)}}]);