/*! For license information please see 22c85585.5cba7909.js.LICENSE.txt */
"use strict";(self.webpackChunkbackstage_microsite=self.webpackChunkbackstage_microsite||[]).push([[965763],{603905:(e,t,n)=>{n.d(t,{Zo:()=>c,kt:()=>k});var r=n(667294);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var l=r.createContext({}),u=function(e){var t=r.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):s(s({},t),e)),n},c=function(e){var t=u(e.components);return r.createElement(l.Provider,{value:t},e.children)},p="mdxType",d={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},h=r.forwardRef((function(e,t){var n=e.components,o=e.mdxType,a=e.originalType,l=e.parentName,c=i(e,["components","mdxType","originalType","parentName"]),p=u(n),h=o,k=p["".concat(l,".").concat(h)]||p[h]||d[h]||a;return n?r.createElement(k,s(s({ref:t},c),{},{components:n})):r.createElement(k,s({ref:t},c))}));function k(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var a=n.length,s=new Array(a);s[0]=h;var i={};for(var l in t)hasOwnProperty.call(t,l)&&(i[l]=t[l]);i.originalType=e,i[p]="string"==typeof e?e:o,s[1]=i;for(var u=2;u<a;u++)s[u]=n[u];return r.createElement.apply(null,s)}return r.createElement.apply(null,n)}h.displayName="MDXCreateElement"},504736:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>u,contentTitle:()=>i,default:()=>d,frontMatter:()=>s,metadata:()=>l,toc:()=>c});n(827378);var r=n(603905);function o(){return o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},o.apply(this,arguments)}function a(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}const s={id:"configuration",title:"Configuring Kubernetes integration",sidebar_label:"Configuration",description:"Configuring the Kubernetes integration for Backstage expose your entity's objects"},i=void 0,l={unversionedId:"features/kubernetes/configuration",id:"features/kubernetes/configuration",title:"Configuring Kubernetes integration",description:"Configuring the Kubernetes integration for Backstage expose your entity's objects",source:"@site/../docs/features/kubernetes/configuration.md",sourceDirName:"features/kubernetes",slug:"/features/kubernetes/configuration",permalink:"/docs/features/kubernetes/configuration",draft:!1,editUrl:"https://github.com/backstage/backstage/edit/master/docs/../docs/features/kubernetes/configuration.md",tags:[],version:"current",frontMatter:{id:"configuration",title:"Configuring Kubernetes integration",sidebar_label:"Configuration",description:"Configuring the Kubernetes integration for Backstage expose your entity's objects"},sidebar:"docs",previous:{title:"Installation",permalink:"/docs/features/kubernetes/installation"},next:{title:"Kubernetes Authentication",permalink:"/docs/features/kubernetes/authentication"}},u={},c=[{value:"Configuring Kubernetes Clusters",id:"configuring-kubernetes-clusters",level:2},{value:"<code>serviceLocatorMethod</code>",id:"servicelocatormethod",level:3},{value:"<code>clusterLocatorMethods</code>",id:"clusterlocatormethods",level:3},{value:"<code>catalog</code>",id:"catalog",level:4},{value:"<code>localKubectlProxy</code>",id:"localkubectlproxy",level:4},{value:"<code>config</code>",id:"config",level:4},{value:"<code>clusters</code>",id:"clusters",level:5},{value:"<code>clusters.*.url</code>",id:"clustersurl",level:5},{value:"<code>clusters.*.name</code>",id:"clustersname",level:5},{value:"<code>clusters.*.authProvider</code>",id:"clustersauthprovider",level:5},{value:"<code>clusters.*.skipTLSVerify</code>",id:"clustersskiptlsverify",level:5},{value:"<code>clusters.*.skipMetricsLookup</code>",id:"clustersskipmetricslookup",level:5},{value:"<code>clusters.*.serviceAccountToken</code> (optional)",id:"clustersserviceaccounttoken-optional",level:5},{value:"<code>clusters.*.oidcTokenProvider</code> (optional)",id:"clustersoidctokenprovider-optional",level:5},{value:"<code>clusters.*.dashboardUrl</code> (optional)",id:"clustersdashboardurl-optional",level:5},{value:"<code>clusters.*.dashboardApp</code> (optional)",id:"clustersdashboardapp-optional",level:5},{value:"<code>clusters.*.dashboardParameters</code> (optional)",id:"clustersdashboardparameters-optional",level:5},{value:"required parameters for GKE",id:"required-parameters-for-gke",level:6},{value:"<code>clusters.*.caData</code> (optional)",id:"clusterscadata-optional",level:5},{value:"<code>clusters.*.caFile</code> (optional)",id:"clusterscafile-optional",level:5},{value:"<code>clusters.*.customResources</code> (optional)",id:"clusterscustomresources-optional",level:5},{value:"<code>gke</code>",id:"gke",level:4},{value:"<code>projectId</code>",id:"projectid",level:5},{value:"<code>region</code> (optional)",id:"region-optional",level:5},{value:"<code>skipTLSVerify</code> (optional)",id:"skiptlsverify-optional",level:5},{value:"<code>skipMetricsLookup</code> (optional)",id:"skipmetricslookup-optional",level:5},{value:"<code>exposeDashboard</code> (optional)",id:"exposedashboard-optional",level:5},{value:"<code>matchingResourceLabels</code> (optional)",id:"matchingresourcelabels-optional",level:5},{value:"Custom <code>KubernetesClustersSupplier</code>",id:"custom-kubernetesclusterssupplier",level:4},{value:"<code>customResources</code> (optional)",id:"customresources-optional",level:3},{value:"<code>customResources.*.group</code>",id:"customresourcesgroup",level:4},{value:"<code>customResources.*.apiVersion</code>",id:"customresourcesapiversion",level:4},{value:"<code>customResources.*.plural</code>",id:"customresourcesplural",level:4},{value:"<code>apiVersionOverrides</code> (optional)",id:"apiversionoverrides-optional",level:3},{value:"<code>objectTypes</code> (optional)",id:"objecttypes-optional",level:3},{value:"Role Based Access Control",id:"role-based-access-control",level:3},{value:"Surfacing your Kubernetes components as part of an entity",id:"surfacing-your-kubernetes-components-as-part-of-an-entity",level:2},{value:"Common <code>backstage.io/kubernetes-id</code> label",id:"common-backstageiokubernetes-id-label",level:3},{value:"Adding the entity annotation",id:"adding-the-entity-annotation",level:4},{value:"Adding the namespace annotation",id:"adding-the-namespace-annotation",level:4},{value:"Labeling Kubernetes components",id:"labeling-kubernetes-components",level:4},{value:"Label selector query annotation",id:"label-selector-query-annotation",level:3}],p={toc:c};function d(e){var{components:t}=e,n=a(e,["components"]);return(0,r.kt)("wrapper",o({},p,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("p",null,"Configuring the Backstage Kubernetes integration involves two steps:"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"Enabling the backend to collect objects from your Kubernetes cluster(s)."),(0,r.kt)("li",{parentName:"ol"},"Surfacing your Kubernetes objects in catalog entities")),(0,r.kt)("h2",o({},{id:"configuring-kubernetes-clusters"}),"Configuring Kubernetes Clusters"),(0,r.kt)("p",null,"The following is a full example entry in ",(0,r.kt)("inlineCode",{parentName:"p"},"app-config.yaml"),":"),(0,r.kt)("pre",null,(0,r.kt)("code",o({parentName:"pre"},{className:"language-yaml"}),"kubernetes:\n  serviceLocatorMethod:\n    type: 'multiTenant'\n  clusterLocatorMethods:\n    - type: 'config'\n      clusters:\n        - url: http://127.0.0.1:9999\n          name: minikube\n          authProvider: 'serviceAccount'\n          skipTLSVerify: false\n          skipMetricsLookup: true\n          serviceAccountToken: ${K8S_MINIKUBE_TOKEN}\n          dashboardUrl: http://127.0.0.1:64713 # url copied from running the command: minikube service kubernetes-dashboard -n kubernetes-dashboard\n          dashboardApp: standard\n          caData: ${K8S_CONFIG_CA_DATA}\n          caFile: '' # local path to CA file\n          customResources:\n            - group: 'argoproj.io'\n              apiVersion: 'v1alpha1'\n              plural: 'rollouts'\n        - url: http://127.0.0.2:9999\n          name: aws-cluster-1\n          authProvider: 'aws'\n    - type: 'gke'\n      projectId: 'gke-clusters'\n      region: 'europe-west1'\n      skipTLSVerify: true\n      skipMetricsLookup: true\n      exposeDashboard: true\n")),(0,r.kt)("h3",o({},{id:"servicelocatormethod"}),(0,r.kt)("inlineCode",{parentName:"h3"},"serviceLocatorMethod")),(0,r.kt)("p",null,"This configures how to determine which clusters a component is running in."),(0,r.kt)("p",null,"Currently, the only valid value is:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"multiTenant")," - This configuration assumes that all components run on all the\nprovided clusters.")),(0,r.kt)("h3",o({},{id:"clusterlocatormethods"}),(0,r.kt)("inlineCode",{parentName:"h3"},"clusterLocatorMethods")),(0,r.kt)("p",null,"This is an array used to determine where to retrieve cluster configuration from."),(0,r.kt)("p",null,"Valid cluster locator methods are:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",o({parentName:"li"},{href:"#catalog"}),(0,r.kt)("inlineCode",{parentName:"a"},"catalog"))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",o({parentName:"li"},{href:"#localkubectlproxy"}),(0,r.kt)("inlineCode",{parentName:"a"},"localKubectlProxy"))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",o({parentName:"li"},{href:"#config"}),(0,r.kt)("inlineCode",{parentName:"a"},"config"))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",o({parentName:"li"},{href:"#gke"}),(0,r.kt)("inlineCode",{parentName:"a"},"gke"))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",o({parentName:"li"},{href:"#custom-kubernetesclusterssupplier"}),"custom ",(0,r.kt)("inlineCode",{parentName:"a"},"KubernetesClustersSupplier")))),(0,r.kt)("h4",o({},{id:"catalog"}),(0,r.kt)("inlineCode",{parentName:"h4"},"catalog")),(0,r.kt)("p",null,"This cluster locator method will read cluster information from the catalog."),(0,r.kt)("h4",o({},{id:"localkubectlproxy"}),(0,r.kt)("inlineCode",{parentName:"h4"},"localKubectlProxy")),(0,r.kt)("p",null,"This cluster locator method will assume a locally running ",(0,r.kt)("a",o({parentName:"p"},{href:"https://kubernetes.io/docs/tasks/extend-kubernetes/http-proxy-access-api/#using-kubectl-to-start-a-proxy-server"}),(0,r.kt)("inlineCode",{parentName:"a"},"kubectl proxy"))," process using the default port (8001)."),(0,r.kt)("p",null,"NOTE: This cluster locator method is for local development only and should not be used in production."),(0,r.kt)("h4",o({},{id:"config"}),(0,r.kt)("inlineCode",{parentName:"h4"},"config")),(0,r.kt)("p",null,"This cluster locator method will read cluster information from your app-config\n(see below)."),(0,r.kt)("h5",o({},{id:"clusters"}),(0,r.kt)("inlineCode",{parentName:"h5"},"clusters")),(0,r.kt)("p",null,"Used by the ",(0,r.kt)("inlineCode",{parentName:"p"},"config")," cluster locator method to construct Kubernetes clients."),(0,r.kt)("h5",o({},{id:"clustersurl"}),(0,r.kt)("inlineCode",{parentName:"h5"},"clusters.\\*.url")),(0,r.kt)("p",null,'The base URL to the Kubernetes control plane. Can be found by using the\n"Kubernetes master" result from running the ',(0,r.kt)("inlineCode",{parentName:"p"},"kubectl cluster-info")," command."),(0,r.kt)("h5",o({},{id:"clustersname"}),(0,r.kt)("inlineCode",{parentName:"h5"},"clusters.\\*.name")),(0,r.kt)("p",null,"A name to represent this cluster, this must be unique within the ",(0,r.kt)("inlineCode",{parentName:"p"},"clusters"),"\narray. Users will see this value in the Software Catalog Kubernetes plugin."),(0,r.kt)("h5",o({},{id:"clustersauthprovider"}),(0,r.kt)("inlineCode",{parentName:"h5"},"clusters.\\*.authProvider")),(0,r.kt)("p",null,"This determines how the Kubernetes client authenticates with the Kubernetes\ncluster. Valid values are:"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",o({parentName:"tr"},{align:null}),"Value"),(0,r.kt)("th",o({parentName:"tr"},{align:null}),"Description"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",o({parentName:"tr"},{align:null}),(0,r.kt)("inlineCode",{parentName:"td"},"serviceAccount")),(0,r.kt)("td",o({parentName:"tr"},{align:null}),"This will use a Kubernetes ",(0,r.kt)("a",o({parentName:"td"},{href:"https://kubernetes.io/docs/reference/access-authn-authz/service-accounts-admin/"}),"service account")," to access the Kubernetes API. When this is used the ",(0,r.kt)("inlineCode",{parentName:"td"},"serviceAccountToken")," field should also be set.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",o({parentName:"tr"},{align:null}),(0,r.kt)("inlineCode",{parentName:"td"},"google")),(0,r.kt)("td",o({parentName:"tr"},{align:null}),"This will use a user's Google auth token from the ",(0,r.kt)("a",o({parentName:"td"},{href:"https://backstage.io/docs/auth/"}),"Google auth plugin")," to access the Kubernetes API.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",o({parentName:"tr"},{align:null}),(0,r.kt)("inlineCode",{parentName:"td"},"aws")),(0,r.kt)("td",o({parentName:"tr"},{align:null}),"This will use AWS credentials to access resources in EKS clusters")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",o({parentName:"tr"},{align:null}),(0,r.kt)("inlineCode",{parentName:"td"},"googleServiceAccount")),(0,r.kt)("td",o({parentName:"tr"},{align:null}),"This will use the Google Cloud service account credentials to access resources in clusters")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",o({parentName:"tr"},{align:null}),(0,r.kt)("inlineCode",{parentName:"td"},"azure")),(0,r.kt)("td",o({parentName:"tr"},{align:null}),"This will use ",(0,r.kt)("a",o({parentName:"td"},{href:"https://docs.microsoft.com/en-us/azure/active-directory/managed-identities-azure-resources/overview"}),"Azure Identity")," to access resources in clusters")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",o({parentName:"tr"},{align:null}),(0,r.kt)("inlineCode",{parentName:"td"},"oidc")),(0,r.kt)("td",o({parentName:"tr"},{align:null}),"This will use ",(0,r.kt)("a",o({parentName:"td"},{href:"https://kubernetes.io/docs/reference/access-authn-authz/authentication/#openid-connect-tokens"}),"Oidc Tokens")," to authenticate to the Kubernetes API. When this is used the ",(0,r.kt)("inlineCode",{parentName:"td"},"oidcTokenProvider")," field should also be set. Please note the cluster must support OIDC, at the time of writing AKS clusters do not support OIDC.")))),(0,r.kt)("p",null,"Check the ",(0,r.kt)("a",o({parentName:"p"},{href:"https://backstage.io/docs/features/kubernetes/authentication"}),"Kubernetes Authentication")," section for additional explanation."),(0,r.kt)("h5",o({},{id:"clustersskiptlsverify"}),(0,r.kt)("inlineCode",{parentName:"h5"},"clusters.\\*.skipTLSVerify")),(0,r.kt)("p",null,"This determines whether the Kubernetes client verifies the TLS certificate\npresented by the API server. Defaults to ",(0,r.kt)("inlineCode",{parentName:"p"},"false"),"."),(0,r.kt)("h5",o({},{id:"clustersskipmetricslookup"}),(0,r.kt)("inlineCode",{parentName:"h5"},"clusters.\\*.skipMetricsLookup")),(0,r.kt)("p",null,"This determines whether the Kubernetes client looks up resource metrics\nCPU/Memory for pods returned by the API server. Defaults to ",(0,r.kt)("inlineCode",{parentName:"p"},"false"),"."),(0,r.kt)("h5",o({},{id:"clustersserviceaccounttoken-optional"}),(0,r.kt)("inlineCode",{parentName:"h5"},"clusters.\\*.serviceAccountToken")," (optional)"),(0,r.kt)("p",null,"The service account token to be used when using the ",(0,r.kt)("inlineCode",{parentName:"p"},"serviceAccount")," auth\nprovider. You could get the service account token with:"),(0,r.kt)("pre",null,(0,r.kt)("code",o({parentName:"pre"},{className:"language-sh"}),"kubectl -n <NAMESPACE> get secret $(kubectl -n <NAMESPACE> get sa <SERVICE_ACCOUNT_NAME> -o=json \\\n| jq -r '.secrets[0].name') -o=json \\\n| jq -r '.data[\"token\"]' \\\n| base64 --decode\n")),(0,r.kt)("h5",o({},{id:"clustersoidctokenprovider-optional"}),(0,r.kt)("inlineCode",{parentName:"h5"},"clusters.\\*.oidcTokenProvider")," (optional)"),(0,r.kt)("p",null,"This field is to be used when using the ",(0,r.kt)("inlineCode",{parentName:"p"},"oidc")," auth provider. It will use the id tokens\nfrom a configured ",(0,r.kt)("a",o({parentName:"p"},{href:"https://backstage.io/docs/auth/"}),"backstage auth provider")," to\nauthenticate to the cluster. The selected ",(0,r.kt)("inlineCode",{parentName:"p"},"oidcTokenProvider")," needs to be properly\nconfigured under ",(0,r.kt)("inlineCode",{parentName:"p"},"auth")," for this to work."),(0,r.kt)("pre",null,(0,r.kt)("code",o({parentName:"pre"},{className:"language-yaml"}),"kubernetes:\n  clusterLocatorMethods:\n    - type: 'config'\n      clusters:\n        - name: test-cluster\n          url: http://localhost:8080\n          authProvider: oidc\n          oidcTokenProvider: okta # This value needs to match a config under auth.providers\nauth:\n  providers:\n    okta:\n      development:\n        clientId: ${AUTH_OKTA_CLIENT_ID}\n        clientSecret: ${AUTH_OKTA_CLIENT_SECRET}\n        audience: ${AUTH_OKTA_AUDIENCE}\n")),(0,r.kt)("p",null,"The following values are supported out-of-the-box by the frontend: ",(0,r.kt)("inlineCode",{parentName:"p"},"gitlab")," (the\napplication whose ",(0,r.kt)("inlineCode",{parentName:"p"},"clientId")," is used by the auth provider should be granted the\n",(0,r.kt)("inlineCode",{parentName:"p"},"openid")," scope), ",(0,r.kt)("inlineCode",{parentName:"p"},"google"),", ",(0,r.kt)("inlineCode",{parentName:"p"},"microsoft"),", ",(0,r.kt)("inlineCode",{parentName:"p"},"okta"),", ",(0,r.kt)("inlineCode",{parentName:"p"},"onelogin"),"."),(0,r.kt)("p",null,"Take note that ",(0,r.kt)("inlineCode",{parentName:"p"},"oidcTokenProvider")," is just the issuer for the token, you can use any\nof these with an OIDC enabled cluster, like using ",(0,r.kt)("inlineCode",{parentName:"p"},"microsoft")," as the issuer for a EKS\ncluster."),(0,r.kt)("h5",o({},{id:"clustersdashboardurl-optional"}),(0,r.kt)("inlineCode",{parentName:"h5"},"clusters.\\*.dashboardUrl")," (optional)"),(0,r.kt)("p",null,"Specifies the link to the Kubernetes dashboard managing this cluster."),(0,r.kt)("p",null,"Note that you should specify the app used for the dashboard using the\n",(0,r.kt)("inlineCode",{parentName:"p"},"dashboardApp")," property, in order to properly format links to kubernetes\nresources, otherwise it will assume that you're running the standard one."),(0,r.kt)("p",null,"Note also that this attribute is optional for some kinds of dashboards, such as\nGKE, which requires additional parameters specified in the ",(0,r.kt)("inlineCode",{parentName:"p"},"dashboardParameters"),"\noption."),(0,r.kt)("h5",o({},{id:"clustersdashboardapp-optional"}),(0,r.kt)("inlineCode",{parentName:"h5"},"clusters.\\*.dashboardApp")," (optional)"),(0,r.kt)("p",null,"Specifies the app that provides the Kubernetes dashboard."),(0,r.kt)("p",null,"This will be used for formatting links to kubernetes objects inside the\ndashboard."),(0,r.kt)("p",null,"The supported dashboards are: ",(0,r.kt)("inlineCode",{parentName:"p"},"standard"),", ",(0,r.kt)("inlineCode",{parentName:"p"},"rancher"),", ",(0,r.kt)("inlineCode",{parentName:"p"},"openshift"),", ",(0,r.kt)("inlineCode",{parentName:"p"},"gke"),", ",(0,r.kt)("inlineCode",{parentName:"p"},"aks"),",\n",(0,r.kt)("inlineCode",{parentName:"p"},"eks"),". However, not all of them are implemented yet, so please contribute!"),(0,r.kt)("p",null,"Note that it will default to the regular dashboard provided by the Kubernetes\nproject (",(0,r.kt)("inlineCode",{parentName:"p"},"standard"),"), that can run in any Kubernetes cluster."),(0,r.kt)("p",null,"Note that for the ",(0,r.kt)("inlineCode",{parentName:"p"},"gke")," app, you must provide additional information in the\n",(0,r.kt)("inlineCode",{parentName:"p"},"dashboardParameters")," option."),(0,r.kt)("p",null,"Note that you can add your own formatter by registering it to the\n",(0,r.kt)("inlineCode",{parentName:"p"},"clusterLinksFormatters")," dictionary, in the app project."),(0,r.kt)("p",null,"Example:"),(0,r.kt)("pre",null,(0,r.kt)("code",o({parentName:"pre"},{className:"language-ts"}),"import { clusterLinksFormatters } from '@backstage/plugin-kubernetes';\nclusterLinksFormatters.myDashboard = (options) => ...;\n")),(0,r.kt)("p",null,"See also\n",(0,r.kt)("a",o({parentName:"p"},{href:"https://github.com/backstage/backstage/tree/master/plugins/kubernetes/src/utils/clusterLinks/formatters"}),"https://github.com/backstage/backstage/tree/master/plugins/kubernetes/src/utils/clusterLinks/formatters"),"\nfor real examples."),(0,r.kt)("h5",o({},{id:"clustersdashboardparameters-optional"}),(0,r.kt)("inlineCode",{parentName:"h5"},"clusters.\\*.dashboardParameters")," (optional)"),(0,r.kt)("p",null,"Specifies additional information for the selected ",(0,r.kt)("inlineCode",{parentName:"p"},"dashboardApp")," formatter."),(0,r.kt)("p",null,"Note that, even though ",(0,r.kt)("inlineCode",{parentName:"p"},"dashboardParameters")," is optional, it might be mandatory\nfor some dashboards, such as GKE."),(0,r.kt)("h6",o({},{id:"required-parameters-for-gke"}),"required parameters for GKE"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",o({parentName:"tr"},{align:null}),"Name"),(0,r.kt)("th",o({parentName:"tr"},{align:null}),"Description"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",o({parentName:"tr"},{align:null}),(0,r.kt)("inlineCode",{parentName:"td"},"projectId")),(0,r.kt)("td",o({parentName:"tr"},{align:null}),"the ID of the GCP project containing your Kubernetes clusters")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",o({parentName:"tr"},{align:null}),(0,r.kt)("inlineCode",{parentName:"td"},"region")),(0,r.kt)("td",o({parentName:"tr"},{align:null}),"the region of GCP containing your Kubernetes clusters")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",o({parentName:"tr"},{align:null}),(0,r.kt)("inlineCode",{parentName:"td"},"clusterName")),(0,r.kt)("td",o({parentName:"tr"},{align:null}),"the name of your kubernetes cluster, within your ",(0,r.kt)("inlineCode",{parentName:"td"},"projectId")," GCP project")))),(0,r.kt)("p",null,"Note that the GKE cluster locator can automatically provide the values for the\n",(0,r.kt)("inlineCode",{parentName:"p"},"dashboardApp")," and ",(0,r.kt)("inlineCode",{parentName:"p"},"dashboardParameters")," options if you set the\n",(0,r.kt)("inlineCode",{parentName:"p"},"exposeDashboard")," property to ",(0,r.kt)("inlineCode",{parentName:"p"},"true"),"."),(0,r.kt)("p",null,"Example:"),(0,r.kt)("pre",null,(0,r.kt)("code",o({parentName:"pre"},{className:"language-yaml"}),"kubernetes:\n  serviceLocatorMethod:\n    type: 'multiTenant'\n  clusterLocatorMethods:\n    - type: 'config'\n      clusters:\n        - url: http://127.0.0.1:9999\n          name: my-cluster\n          dashboardApp: gke\n          dashboardParameters:\n            projectId: my-project\n            region: us-east1\n            clusterName: my-cluster\n")),(0,r.kt)("h5",o({},{id:"clusterscadata-optional"}),(0,r.kt)("inlineCode",{parentName:"h5"},"clusters.\\*.caData")," (optional)"),(0,r.kt)("p",null,"Base64-encoded certificate authority bundle in PEM format. The Kubernetes client\nwill verify that the TLS certificate presented by the API server is signed by\nthis CA."),(0,r.kt)("p",null,"This value could be obtained via inspecting the kubeconfig file (usually\nat ",(0,r.kt)("inlineCode",{parentName:"p"},"~/.kube/config"),") under ",(0,r.kt)("inlineCode",{parentName:"p"},"clusters[*].cluster.certificate-authority-data"),". For\nGKE, execute the following command to obtain the value"),(0,r.kt)("pre",null,(0,r.kt)("code",o({parentName:"pre"},{}),'gcloud container clusters describe <YOUR_CLUSTER_NAME> \\\n    --zone=<YOUR_COMPUTE_ZONE> \\\n    --format="value(masterAuth.clusterCaCertificate)"\n')),(0,r.kt)("p",null,"See also\n",(0,r.kt)("a",o({parentName:"p"},{href:"https://cloud.google.com/kubernetes-engine/docs/how-to/api-server-authentication#environments-without-gcloud"}),"https://cloud.google.com/kubernetes-engine/docs/how-to/api-server-authentication#environments-without-gcloud"),"\nfor complete docs about GKE without ",(0,r.kt)("inlineCode",{parentName:"p"},"gcloud"),"."),(0,r.kt)("h5",o({},{id:"clusterscafile-optional"}),(0,r.kt)("inlineCode",{parentName:"h5"},"clusters.\\*.caFile")," (optional)"),(0,r.kt)("p",null,"Filesystem path (on the host where the Backstage process is running) to a\ncertificate authority bundle in PEM format. The Kubernetes client will verify\nthat the TLS certificate presented by the API server is signed by this CA. Note\nthat only clusters defined in the app-config via the ",(0,r.kt)("a",o({parentName:"p"},{href:"#config"}),(0,r.kt)("inlineCode",{parentName:"a"},"config")),"\ncluster locator method can be configured in this way."),(0,r.kt)("h5",o({},{id:"clusterscustomresources-optional"}),(0,r.kt)("inlineCode",{parentName:"h5"},"clusters.\\*.customResources")," (optional)"),(0,r.kt)("p",null,"Configures which ",(0,r.kt)("a",o({parentName:"p"},{href:"https://kubernetes.io/docs/concepts/extend-kubernetes/api-extension/custom-resources/"}),"custom resources")," to look for when returning an entity's\nKubernetes resources belonging to the cluster. Same specification as ",(0,r.kt)("a",o({parentName:"p"},{href:"#customresources-optional"}),(0,r.kt)("inlineCode",{parentName:"a"},"customResources"))),(0,r.kt)("h4",o({},{id:"gke"}),(0,r.kt)("inlineCode",{parentName:"h4"},"gke")),(0,r.kt)("p",null,"This cluster locator is designed to work with Kubernetes clusters running in\n",(0,r.kt)("a",o({parentName:"p"},{href:"https://cloud.google.com/kubernetes-engine"}),"GKE"),". It will configure the Kubernetes backend plugin to make requests to\nclusters running within a Google Cloud project."),(0,r.kt)("p",null,"This cluster locator method will use the ",(0,r.kt)("inlineCode",{parentName:"p"},"google")," authentication mechanism."),(0,r.kt)("p",null,"The Google Cloud service account to use can be configured through the\n",(0,r.kt)("inlineCode",{parentName:"p"},"GOOGLE_APPLICATION_CREDENTIALS")," environment variable. Consult the ",(0,r.kt)("a",o({parentName:"p"},{href:"https://cloud.google.com/docs/authentication/production#linux-or-macos"}),"Google Cloud\ndocs")," for more information."),(0,r.kt)("p",null,"For example:"),(0,r.kt)("pre",null,(0,r.kt)("code",o({parentName:"pre"},{className:"language-yaml"}),"- type: 'gke'\n  projectId: 'gke-clusters'\n  region: 'europe-west1' # optional\n  skipTLSVerify: false # optional\n  skipMetricsLookup: false # optional\n  exposeDashboard: false # optional\n  matchingResourceLabels: # optional\n    - key: 'environment'\n      value: 'production'\n")),(0,r.kt)("p",null,"Will configure the Kubernetes plugin to connect to all GKE clusters in the\nproject ",(0,r.kt)("inlineCode",{parentName:"p"},"gke-clusters")," in the region ",(0,r.kt)("inlineCode",{parentName:"p"},"europe-west1"),"."),(0,r.kt)("p",null,"Note that the GKE cluster locator can automatically provide the values for the\n",(0,r.kt)("inlineCode",{parentName:"p"},"dashboardApp")," and ",(0,r.kt)("inlineCode",{parentName:"p"},"dashboardParameters")," options if you enable the\n",(0,r.kt)("inlineCode",{parentName:"p"},"exposeDashboard")," option."),(0,r.kt)("h5",o({},{id:"projectid"}),(0,r.kt)("inlineCode",{parentName:"h5"},"projectId")),(0,r.kt)("p",null,"The Google Cloud project to look for Kubernetes clusters in."),(0,r.kt)("h5",o({},{id:"region-optional"}),(0,r.kt)("inlineCode",{parentName:"h5"},"region")," (optional)"),(0,r.kt)("p",null,"The Google Cloud region to look for Kubernetes clusters in. Defaults to all\nregions."),(0,r.kt)("h5",o({},{id:"skiptlsverify-optional"}),(0,r.kt)("inlineCode",{parentName:"h5"},"skipTLSVerify")," (optional)"),(0,r.kt)("p",null,"This determines whether the Kubernetes client verifies the TLS certificate\npresented by the API server. Defaults to ",(0,r.kt)("inlineCode",{parentName:"p"},"false"),"."),(0,r.kt)("h5",o({},{id:"skipmetricslookup-optional"}),(0,r.kt)("inlineCode",{parentName:"h5"},"skipMetricsLookup")," (optional)"),(0,r.kt)("p",null,"This determines whether the Kubernetes client looks up resource metrics\nCPU/Memory for pods returned by the API server. Defaults to ",(0,r.kt)("inlineCode",{parentName:"p"},"false"),"."),(0,r.kt)("h5",o({},{id:"exposedashboard-optional"}),(0,r.kt)("inlineCode",{parentName:"h5"},"exposeDashboard")," (optional)"),(0,r.kt)("p",null,"This determines whether the ",(0,r.kt)("inlineCode",{parentName:"p"},"dashboardApp")," and ",(0,r.kt)("inlineCode",{parentName:"p"},"dashboardParameters")," should be\nautomatically configured in order to expose the GKE dashboard from the\nKubernetes plugin."),(0,r.kt)("p",null,"Defaults to ",(0,r.kt)("inlineCode",{parentName:"p"},"false"),"."),(0,r.kt)("h5",o({},{id:"matchingresourcelabels-optional"}),(0,r.kt)("inlineCode",{parentName:"h5"},"matchingResourceLabels")," (optional)"),(0,r.kt)("p",null,"Array of key value labels used to filter out clusters which don't have the matching\n",(0,r.kt)("a",o({parentName:"p"},{href:"https://cloud.google.com/resource-manager/docs/creating-managing-labels"}),"resource labels"),"."),(0,r.kt)("h4",o({},{id:"custom-kubernetesclusterssupplier"}),"Custom ",(0,r.kt)("inlineCode",{parentName:"h4"},"KubernetesClustersSupplier")),(0,r.kt)("p",null,"If the configuration-based cluster locators do not work for your use-case,\nit is also possible to implement a\n",(0,r.kt)("a",o({parentName:"p"},{href:"/docs/features/kubernetes/installation#custom-cluster-discovery"}),"custom ",(0,r.kt)("inlineCode",{parentName:"a"},"KubernetesClustersSupplier")),"."),(0,r.kt)("h3",o({},{id:"customresources-optional"}),(0,r.kt)("inlineCode",{parentName:"h3"},"customResources")," (optional)"),(0,r.kt)("p",null,"Configures which ",(0,r.kt)("a",o({parentName:"p"},{href:"https://kubernetes.io/docs/concepts/extend-kubernetes/api-extension/custom-resources/"}),"custom resources")," to look for by default when returning an entity's\nKubernetes resources."),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Notes:")),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"The optional ",(0,r.kt)("inlineCode",{parentName:"li"},"kubernetes.customResources")," property is overrode by ",(0,r.kt)("inlineCode",{parentName:"li"},"customResources")," at the ",(0,r.kt)("a",o({parentName:"li"},{href:"#clusterscustomresources-optional"}),"clusters level"),".")),(0,r.kt)("p",null,"Defaults to empty array. Example:"),(0,r.kt)("pre",null,(0,r.kt)("code",o({parentName:"pre"},{className:"language-yaml"}),"---\nkubernetes:\n  customResources:\n    - group: 'argoproj.io'\n      apiVersion: 'v1alpha1'\n      plural: 'rollouts'\n")),(0,r.kt)("h4",o({},{id:"customresourcesgroup"}),(0,r.kt)("inlineCode",{parentName:"h4"},"customResources.\\*.group")),(0,r.kt)("p",null,"The custom resource's group."),(0,r.kt)("h4",o({},{id:"customresourcesapiversion"}),(0,r.kt)("inlineCode",{parentName:"h4"},"customResources.\\*.apiVersion")),(0,r.kt)("p",null,"The custom resource's apiVersion."),(0,r.kt)("h4",o({},{id:"customresourcesplural"}),(0,r.kt)("inlineCode",{parentName:"h4"},"customResources.\\*.plural")),(0,r.kt)("p",null,"The plural representing the custom resource."),(0,r.kt)("h3",o({},{id:"apiversionoverrides-optional"}),(0,r.kt)("inlineCode",{parentName:"h3"},"apiVersionOverrides")," (optional)"),(0,r.kt)("p",null,"Overrides for the API versions used to make requests for the corresponding\nobjects. If using a legacy Kubernetes version, you may use this config to\noverride the default API versions to ones that are supported by your cluster."),(0,r.kt)("p",null,"Example:"),(0,r.kt)("pre",null,(0,r.kt)("code",o({parentName:"pre"},{className:"language-yaml"}),"---\nkubernetes:\n  apiVersionOverrides:\n    cronjobs: 'v1beta1'\n")),(0,r.kt)("p",null,"For more information on which API versions are supported by your cluster, please\nview the Kubernetes API docs for your Kubernetes version (e.g.\n",(0,r.kt)("a",o({parentName:"p"},{href:"https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.22/#-strong-api-groups-strong-"}),"API Groups for v1.22"),"\n)"),(0,r.kt)("h3",o({},{id:"objecttypes-optional"}),(0,r.kt)("inlineCode",{parentName:"h3"},"objectTypes")," (optional)"),(0,r.kt)("p",null,"Overrides for the Kubernetes object types fetched from the cluster. The default object types are:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"pods"),(0,r.kt)("li",{parentName:"ul"},"services"),(0,r.kt)("li",{parentName:"ul"},"configmaps"),(0,r.kt)("li",{parentName:"ul"},"limitranges"),(0,r.kt)("li",{parentName:"ul"},"deployments"),(0,r.kt)("li",{parentName:"ul"},"replicasets"),(0,r.kt)("li",{parentName:"ul"},"horizontalpodautoscalers"),(0,r.kt)("li",{parentName:"ul"},"jobs"),(0,r.kt)("li",{parentName:"ul"},"cronjobs"),(0,r.kt)("li",{parentName:"ul"},"ingresses"),(0,r.kt)("li",{parentName:"ul"},"statefulsets"),(0,r.kt)("li",{parentName:"ul"},"daemonsets")),(0,r.kt)("p",null,"You may use this config to override the default object types if you only want a subset of\nthe default ones. However, it's currently not supported to fetch object types other\nthan the ones specified in the default types."),(0,r.kt)("p",null,"Example:"),(0,r.kt)("pre",null,(0,r.kt)("code",o({parentName:"pre"},{className:"language-yaml"}),"---\nkubernetes:\n  objectTypes:\n    - configmaps\n    - deployments\n    - limitranges\n    - pods\n    - services\n    - statefulsets\n")),(0,r.kt)("h3",o({},{id:"role-based-access-control"}),"Role Based Access Control"),(0,r.kt)("p",null,"The current RBAC permissions required are read-only cluster wide, the below\nKubernetes manifest describes which objects are required and will ensure\nthe plugin functions correctly:"),(0,r.kt)("pre",null,(0,r.kt)("code",o({parentName:"pre"},{className:"language-yaml"}),"---\napiVersion: rbac.authorization.k8s.io/v1\nkind: ClusterRole\nmetadata:\n  name: backstage-read-only\nrules:\n  - apiGroups:\n      - '*'\n    resources:\n      - pods\n      - configmaps\n      - services\n      - deployments\n      - replicasets\n      - horizontalpodautoscalers\n      - ingresses\n      - statefulsets\n      - limitranges\n      - daemonsets\n    verbs:\n      - get\n      - list\n      - watch\n  - apiGroups:\n      - batch\n    resources:\n      - jobs\n      - cronjobs\n    verbs:\n      - get\n      - list\n      - watch\n  - apiGroups:\n      - metrics.k8s.io\n    resources:\n      - pods\n    verbs:\n      - get\n      - list\n")),(0,r.kt)("h2",o({},{id:"surfacing-your-kubernetes-components-as-part-of-an-entity"}),"Surfacing your Kubernetes components as part of an entity"),(0,r.kt)("p",null,"There are two ways to surface your Kubernetes components as part of an entity.\nThe label selector takes precedence over the annotation/service id."),(0,r.kt)("h3",o({},{id:"common-backstageiokubernetes-id-label"}),"Common ",(0,r.kt)("inlineCode",{parentName:"h3"},"backstage.io/kubernetes-id")," label"),(0,r.kt)("h4",o({},{id:"adding-the-entity-annotation"}),"Adding the entity annotation"),(0,r.kt)("p",null,"In order for Backstage to detect that an entity has Kubernetes components, the\nfollowing annotation should be added to the entity's ",(0,r.kt)("inlineCode",{parentName:"p"},"catalog-info.yaml"),":"),(0,r.kt)("pre",null,(0,r.kt)("code",o({parentName:"pre"},{className:"language-yaml"}),"annotations:\n  'backstage.io/kubernetes-id': dice-roller\n")),(0,r.kt)("h4",o({},{id:"adding-the-namespace-annotation"}),"Adding the namespace annotation"),(0,r.kt)("p",null,"Entities can have the ",(0,r.kt)("inlineCode",{parentName:"p"},"backstage.io/kubernetes-namespace")," annotation, this will cause the entity's Kubernetes resources\nto by looked up via that namespace."),(0,r.kt)("pre",null,(0,r.kt)("code",o({parentName:"pre"},{className:"language-yaml"}),"annotations:\n  'backstage.io/kubernetes-namespace': dice-space\n")),(0,r.kt)("h4",o({},{id:"labeling-kubernetes-components"}),"Labeling Kubernetes components"),(0,r.kt)("p",null,"In order for Kubernetes components to show up in the software catalog as a part\nof an entity, Kubernetes components themselves can have the following label:"),(0,r.kt)("pre",null,(0,r.kt)("code",o({parentName:"pre"},{className:"language-yaml"}),"'backstage.io/kubernetes-id': <BACKSTAGE_ENTITY_NAME>\n")),(0,r.kt)("h3",o({},{id:"label-selector-query-annotation"}),"Label selector query annotation"),(0,r.kt)("p",null,"You can write your own custom label selector query that Backstage will use to\nlookup the objects (similar to ",(0,r.kt)("inlineCode",{parentName:"p"},'kubectl --selector="your query here"'),"). Review\nthe\n",(0,r.kt)("a",o({parentName:"p"},{href:"https://kubernetes.io/docs/concepts/overview/working-with-objects/labels/"}),"labels and selectors Kubernetes documentation"),"\nfor more info."),(0,r.kt)("pre",null,(0,r.kt)("code",o({parentName:"pre"},{className:"language-yaml"}),"'backstage.io/kubernetes-label-selector': 'app=my-app,component=front-end'\n")))}d.isMDXComponent=!0},862525:e=>{var t=Object.getOwnPropertySymbols,n=Object.prototype.hasOwnProperty,r=Object.prototype.propertyIsEnumerable;function o(e){if(null==e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}e.exports=function(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},n=0;n<10;n++)t["_"+String.fromCharCode(n)]=n;if("0123456789"!==Object.getOwnPropertyNames(t).map((function(e){return t[e]})).join(""))return!1;var r={};return"abcdefghijklmnopqrst".split("").forEach((function(e){r[e]=e})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},r)).join("")}catch(o){return!1}}()?Object.assign:function(e,a){for(var s,i,l=o(e),u=1;u<arguments.length;u++){for(var c in s=Object(arguments[u]))n.call(s,c)&&(l[c]=s[c]);if(t){i=t(s);for(var p=0;p<i.length;p++)r.call(s,i[p])&&(l[i[p]]=s[i[p]])}}return l}},541535:(e,t,n)=>{var r=n(862525),o=60103,a=60106;var s=60109,i=60110,l=60112;var u=60115,c=60116;if("function"==typeof Symbol&&Symbol.for){var p=Symbol.for;o=p("react.element"),a=p("react.portal"),p("react.fragment"),p("react.strict_mode"),p("react.profiler"),s=p("react.provider"),i=p("react.context"),l=p("react.forward_ref"),p("react.suspense"),u=p("react.memo"),c=p("react.lazy")}var d="function"==typeof Symbol&&Symbol.iterator;function h(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var k={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},m={};function f(e,t,n){this.props=e,this.context=t,this.refs=m,this.updater=n||k}function b(){}function g(e,t,n){this.props=e,this.context=t,this.refs=m,this.updater=n||k}f.prototype.isReactComponent={},f.prototype.setState=function(e,t){if("object"!=typeof e&&"function"!=typeof e&&null!=e)throw Error(h(85));this.updater.enqueueSetState(this,e,t,"setState")},f.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},b.prototype=f.prototype;var y=g.prototype=new b;y.constructor=g,r(y,f.prototype),y.isPureReactComponent=!0;var v={current:null},N=Object.prototype.hasOwnProperty,C={key:!0,ref:!0,__self:!0,__source:!0};function w(e,t,n){var r,a={},s=null,i=null;if(null!=t)for(r in void 0!==t.ref&&(i=t.ref),void 0!==t.key&&(s=""+t.key),t)N.call(t,r)&&!C.hasOwnProperty(r)&&(a[r]=t[r]);var l=arguments.length-2;if(1===l)a.children=n;else if(1<l){for(var u=Array(l),c=0;c<l;c++)u[c]=arguments[c+2];a.children=u}if(e&&e.defaultProps)for(r in l=e.defaultProps)void 0===a[r]&&(a[r]=l[r]);return{$$typeof:o,type:e,key:s,ref:i,props:a,_owner:v.current}}function T(e){return"object"==typeof e&&null!==e&&e.$$typeof===o}var j=/\/+/g;function K(e,t){return"object"==typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,(function(e){return t[e]}))}(""+e.key):t.toString(36)}function O(e,t,n,r,s){var i=typeof e;"undefined"!==i&&"boolean"!==i||(e=null);var l=!1;if(null===e)l=!0;else switch(i){case"string":case"number":l=!0;break;case"object":switch(e.$$typeof){case o:case a:l=!0}}if(l)return s=s(l=e),e=""===r?"."+K(l,0):r,Array.isArray(s)?(n="",null!=e&&(n=e.replace(j,"$&/")+"/"),O(s,t,n,"",(function(e){return e}))):null!=s&&(T(s)&&(s=function(e,t){return{$$typeof:o,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(s,n+(!s.key||l&&l.key===s.key?"":(""+s.key).replace(j,"$&/")+"/")+e)),t.push(s)),1;if(l=0,r=""===r?".":r+":",Array.isArray(e))for(var u=0;u<e.length;u++){var c=r+K(i=e[u],u);l+=O(i,t,n,c,s)}else if(c=function(e){return null===e||"object"!=typeof e?null:"function"==typeof(e=d&&e[d]||e["@@iterator"])?e:null}(e),"function"==typeof c)for(e=c.call(e),u=0;!(i=e.next()).done;)l+=O(i=i.value,t,n,c=r+K(i,u++),s);else if("object"===i)throw t=""+e,Error(h(31,"[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t));return l}function A(e,t,n){if(null==e)return e;var r=[],o=0;return O(e,r,"","",(function(e){return t.call(n,e,o++)})),r}function P(e){if(-1===e._status){var t=e._result;t=t(),e._status=0,e._result=t,t.then((function(t){0===e._status&&(t=t.default,e._status=1,e._result=t)}),(function(t){0===e._status&&(e._status=2,e._result=t)}))}if(1===e._status)return e._result;throw e._result}var E={current:null};function S(){var e=E.current;if(null===e)throw Error(h(321));return e}},827378:(e,t,n)=>{n(541535)}}]);