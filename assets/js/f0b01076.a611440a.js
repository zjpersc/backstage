/*! For license information please see f0b01076.a611440a.js.LICENSE.txt */
"use strict";(self.webpackChunkbackstage_microsite=self.webpackChunkbackstage_microsite||[]).push([[754389],{603905:(e,t,n)=>{n.d(t,{Zo:()=>p,kt:()=>h});var r=n(667294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var c=r.createContext({}),l=function(e){var t=r.useContext(c),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},p=function(e){var t=l(e.components);return r.createElement(c.Provider,{value:t},e.children)},u="mdxType",f={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},d=r.forwardRef((function(e,t){var n=e.components,a=e.mdxType,o=e.originalType,c=e.parentName,p=s(e,["components","mdxType","originalType","parentName"]),u=l(n),d=a,h=u["".concat(c,".").concat(d)]||u[d]||f[d]||o;return n?r.createElement(h,i(i({ref:t},p),{},{components:n})):r.createElement(h,i({ref:t},p))}));function h(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var o=n.length,i=new Array(o);i[0]=d;var s={};for(var c in t)hasOwnProperty.call(t,c)&&(s[c]=t[c]);s.originalType=e,s[u]="string"==typeof e?e:a,i[1]=s;for(var l=2;l<o;l++)i[l]=n[l];return r.createElement.apply(null,i)}return r.createElement.apply(null,n)}d.displayName="MDXCreateElement"},627391:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>s,default:()=>f,frontMatter:()=>i,metadata:()=>c,toc:()=>p});n(827378);var r=n(603905);function a(){return a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},a.apply(this,arguments)}function o(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}const i={id:"references",title:"Entity References",description:"How to express references between entities"},s=void 0,c={unversionedId:"features/software-catalog/references",id:"features/software-catalog/references",title:"Entity References",description:"How to express references between entities",source:"@site/../docs/features/software-catalog/references.md",sourceDirName:"features/software-catalog",slug:"/features/software-catalog/references",permalink:"/docs/features/software-catalog/references",draft:!1,editUrl:"https://github.com/backstage/backstage/edit/master/docs/../docs/features/software-catalog/references.md",tags:[],version:"current",frontMatter:{id:"references",title:"Entity References",description:"How to express references between entities"},sidebar:"docs",previous:{title:"YAML File Format",permalink:"/docs/features/software-catalog/descriptor-format"},next:{title:"Well-known Annotations",permalink:"/docs/features/software-catalog/well-known-annotations"}},l={},p=[{value:"String References",id:"string-references",level:2},{value:"Compound References",id:"compound-references",level:2}],u={toc:p};function f(e){var{components:t}=e,n=o(e,["components"]);return(0,r.kt)("wrapper",a({},u,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("p",null,"Entities commonly have a need to reference other entities. For example, a\n",(0,r.kt)("a",a({parentName:"p"},{href:"/docs/features/software-catalog/descriptor-format#kind-component"}),"Component")," entity may want to declare who\nits owner is by mentioning a Group or User entity, and a User entity may want to\ndeclare what Group entities it is a member of. This article describes how to\nwrite those references in your yaml entity declaration files."),(0,r.kt)("p",null,"Each entity in the catalog is uniquely identified by the triplet of its\n",(0,r.kt)("a",a({parentName:"p"},{href:"/docs/features/software-catalog/descriptor-format#apiversion-and-kind-required"}),"kind"),",\n",(0,r.kt)("a",a({parentName:"p"},{href:"/docs/features/software-catalog/descriptor-format#namespace-optional"}),"namespace"),", and\n",(0,r.kt)("a",a({parentName:"p"},{href:"/docs/features/software-catalog/descriptor-format#name-required"}),"name"),". But that's a lot to type out\nmanually, and in a lot of circumstances, both the kind and the namespace are\nfixed, or possible to deduce, or could have sane default values. So in order to\nhelp the writer, the catalog has a few tricks up its sleeve."),(0,r.kt)("p",null,"Each reference can be expressed in one of two ways: as a compact string, or as a\ncompound reference structure."),(0,r.kt)("h2",a({},{id:"string-references"}),"String References"),(0,r.kt)("p",null,"This is the most common alternative, that should be used in almost all\ncircumstances."),(0,r.kt)("p",null,"The string is on the form ",(0,r.kt)("inlineCode",{parentName:"p"},"[<kind>:][<namespace>/]<name>"),", that is, it is\ncomposed of between one and three parts in this specific order, without any\nadditional encoding:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Optionally, the kind, followed by a colon"),(0,r.kt)("li",{parentName:"ul"},"Optionally, the namespace, followed by a forward slash"),(0,r.kt)("li",{parentName:"ul"},"The name")),(0,r.kt)("p",null,"The name is always required. Depending on the context, you may be able to leave\nout the kind and/or namespace. If you do, it is contextual what values will be\nused, and the relevant documentation should specify which rule applies where.\nAll strings are case insensitive."),(0,r.kt)("pre",null,(0,r.kt)("code",a({parentName:"pre"},{className:"language-yaml"}),"# Example:\napiVersion: backstage.io/v1alpha1\nkind: Component\nmetadata:\n  name: petstore\n  namespace: external-systems\n  description: Petstore\nspec:\n  type: service\n  lifecycle: experimental\n  owner: group:pet-managers\n  providesApis:\n    - petstore\n    - internal/streetlights\n    - hello-world\n")),(0,r.kt)("p",null,"The field ",(0,r.kt)("inlineCode",{parentName:"p"},"spec.owner")," is a reference. In this case, the string\n",(0,r.kt)("inlineCode",{parentName:"p"},"group:pet-managers")," was given by the user. That means that the kind is ",(0,r.kt)("inlineCode",{parentName:"p"},"Group"),",\nthe namespace is left out, and the name is ",(0,r.kt)("inlineCode",{parentName:"p"},"pet-managers"),". In this context, the\nnamespace was chosen to fall back to the value ",(0,r.kt)("inlineCode",{parentName:"p"},"default")," by the code that parsed\nthe reference, so the end result is that we expect to find another entity in the\ncatalog that is of kind ",(0,r.kt)("inlineCode",{parentName:"p"},"Group"),", namespace ",(0,r.kt)("inlineCode",{parentName:"p"},"default")," (which, actually, also can\nbe left out in its own yaml file because that's the default value there too),\nand name ",(0,r.kt)("inlineCode",{parentName:"p"},"pet-managers"),"."),(0,r.kt)("p",null,"The entries in ",(0,r.kt)("inlineCode",{parentName:"p"},"providesApis")," are also references. In this case, none of them\nneeds to specify a kind since we know from the context that that's the only kind\nthat's supported here. The second entry specifies a namespace but the other ones\ndon't, and in this context, the default is to refer to the same namespace as the\noriginating entity (",(0,r.kt)("inlineCode",{parentName:"p"},"external-systems")," here). So the three references\nessentially expand to ",(0,r.kt)("inlineCode",{parentName:"p"},"api:external-systems/petstore"),",\n",(0,r.kt)("inlineCode",{parentName:"p"},"api:internal/streetlights"),", and ",(0,r.kt)("inlineCode",{parentName:"p"},"api:external-systems/hello-world"),". We expect\nthere to exist three API kind entities in the catalog matching those references."),(0,r.kt)("h2",a({},{id:"compound-references"}),"Compound References"),(0,r.kt)("p",null,"This is a more verbose version of a reference, where each part of the\nkind-namespace-name triplet is expressed as a field in a structure. This format\ncan be used where necessary, such as if either of the three elements contains\ncolons or forward slashes. Avoid using it where possible, since it is harder to\nread and write for humans."),(0,r.kt)("pre",null,(0,r.kt)("code",a({parentName:"pre"},{className:"language-yaml"}),"# Example:\napiVersion: backstage.io/v1alpha1\nkind: Component\nmetadata:\n  name: petstore\n  description: Petstore\nspec:\n  type: service\n  lifecycle: experimental\n  owner:\n    kind: Group\n    name: aegis-imports/pet-managers\n")),(0,r.kt)("p",null,"In this example, the ",(0,r.kt)("inlineCode",{parentName:"p"},"spec.owner")," has been broken apart since the name was\ncomplex. The kind happened to be written with an uppercase letter G, which also\nworks. The namespace was left out just like in the string version above, which\nis handled identically."))}f.isMDXComponent=!0},862525:e=>{var t=Object.getOwnPropertySymbols,n=Object.prototype.hasOwnProperty,r=Object.prototype.propertyIsEnumerable;function a(e){if(null==e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}e.exports=function(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},n=0;n<10;n++)t["_"+String.fromCharCode(n)]=n;if("0123456789"!==Object.getOwnPropertyNames(t).map((function(e){return t[e]})).join(""))return!1;var r={};return"abcdefghijklmnopqrst".split("").forEach((function(e){r[e]=e})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},r)).join("")}catch(a){return!1}}()?Object.assign:function(e,o){for(var i,s,c=a(e),l=1;l<arguments.length;l++){for(var p in i=Object(arguments[l]))n.call(i,p)&&(c[p]=i[p]);if(t){s=t(i);for(var u=0;u<s.length;u++)r.call(i,s[u])&&(c[s[u]]=i[s[u]])}}return c}},541535:(e,t,n)=>{var r=n(862525),a=60103,o=60106;var i=60109,s=60110,c=60112;var l=60115,p=60116;if("function"==typeof Symbol&&Symbol.for){var u=Symbol.for;a=u("react.element"),o=u("react.portal"),u("react.fragment"),u("react.strict_mode"),u("react.profiler"),i=u("react.provider"),s=u("react.context"),c=u("react.forward_ref"),u("react.suspense"),l=u("react.memo"),p=u("react.lazy")}var f="function"==typeof Symbol&&Symbol.iterator;function d(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var h={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},m={};function y(e,t,n){this.props=e,this.context=t,this.refs=m,this.updater=n||h}function b(){}function w(e,t,n){this.props=e,this.context=t,this.refs=m,this.updater=n||h}y.prototype.isReactComponent={},y.prototype.setState=function(e,t){if("object"!=typeof e&&"function"!=typeof e&&null!=e)throw Error(d(85));this.updater.enqueueSetState(this,e,t,"setState")},y.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},b.prototype=y.prototype;var g=w.prototype=new b;g.constructor=w,r(g,y.prototype),g.isPureReactComponent=!0;var k={current:null},v=Object.prototype.hasOwnProperty,O={key:!0,ref:!0,__self:!0,__source:!0};function j(e,t,n){var r,o={},i=null,s=null;if(null!=t)for(r in void 0!==t.ref&&(s=t.ref),void 0!==t.key&&(i=""+t.key),t)v.call(t,r)&&!O.hasOwnProperty(r)&&(o[r]=t[r]);var c=arguments.length-2;if(1===c)o.children=n;else if(1<c){for(var l=Array(c),p=0;p<c;p++)l[p]=arguments[p+2];o.children=l}if(e&&e.defaultProps)for(r in c=e.defaultProps)void 0===o[r]&&(o[r]=c[r]);return{$$typeof:a,type:e,key:i,ref:s,props:o,_owner:k.current}}function x(e){return"object"==typeof e&&null!==e&&e.$$typeof===a}var C=/\/+/g;function N(e,t){return"object"==typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,(function(e){return t[e]}))}(""+e.key):t.toString(36)}function P(e,t,n,r,i){var s=typeof e;"undefined"!==s&&"boolean"!==s||(e=null);var c=!1;if(null===e)c=!0;else switch(s){case"string":case"number":c=!0;break;case"object":switch(e.$$typeof){case a:case o:c=!0}}if(c)return i=i(c=e),e=""===r?"."+N(c,0):r,Array.isArray(i)?(n="",null!=e&&(n=e.replace(C,"$&/")+"/"),P(i,t,n,"",(function(e){return e}))):null!=i&&(x(i)&&(i=function(e,t){return{$$typeof:a,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(i,n+(!i.key||c&&c.key===i.key?"":(""+i.key).replace(C,"$&/")+"/")+e)),t.push(i)),1;if(c=0,r=""===r?".":r+":",Array.isArray(e))for(var l=0;l<e.length;l++){var p=r+N(s=e[l],l);c+=P(s,t,n,p,i)}else if(p=function(e){return null===e||"object"!=typeof e?null:"function"==typeof(e=f&&e[f]||e["@@iterator"])?e:null}(e),"function"==typeof p)for(e=p.call(e),l=0;!(s=e.next()).done;)c+=P(s=s.value,t,n,p=r+N(s,l++),i);else if("object"===s)throw t=""+e,Error(d(31,"[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t));return c}function S(e,t,n){if(null==e)return e;var r=[],a=0;return P(e,r,"","",(function(e){return t.call(n,e,a++)})),r}function E(e){if(-1===e._status){var t=e._result;t=t(),e._status=0,e._result=t,t.then((function(t){0===e._status&&(t=t.default,e._status=1,e._result=t)}),(function(t){0===e._status&&(e._status=2,e._result=t)}))}if(1===e._status)return e._result;throw e._result}var _={current:null};function T(){var e=_.current;if(null===e)throw Error(d(321));return e}},827378:(e,t,n)=>{n(541535)}}]);