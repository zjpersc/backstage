/*! For license information please see a842db86.23f3b212.js.LICENSE.txt */
"use strict";(self.webpackChunkbackstage_microsite=self.webpackChunkbackstage_microsite||[]).push([[431247],{603905:(e,t,n)=>{n.d(t,{Zo:()=>p,kt:()=>m});var r=n(667294);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function a(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n,r,i={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var l=r.createContext({}),c=function(e){var t=r.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):s(s({},t),e)),n},p=function(e){var t=c(e.components);return r.createElement(l.Provider,{value:t},e.children)},u="mdxType",d={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},g=r.forwardRef((function(e,t){var n=e.components,i=e.mdxType,o=e.originalType,l=e.parentName,p=a(e,["components","mdxType","originalType","parentName"]),u=c(n),g=i,m=u["".concat(l,".").concat(g)]||u[g]||d[g]||o;return n?r.createElement(m,s(s({ref:t},p),{},{components:n})):r.createElement(m,s({ref:t},p))}));function m(e,t){var n=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var o=n.length,s=new Array(o);s[0]=g;var a={};for(var l in t)hasOwnProperty.call(t,l)&&(a[l]=t[l]);a.originalType=e,a[u]="string"==typeof e?e:i,s[1]=a;for(var c=2;c<o;c++)s[c]=n[c];return r.createElement.apply(null,s)}return r.createElement.apply(null,n)}g.displayName="MDXCreateElement"},186715:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>c,contentTitle:()=>a,default:()=>d,frontMatter:()=>s,metadata:()=>l,toc:()=>p});n(827378);var r=n(603905);function i(){return i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},i.apply(this,arguments)}function o(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n,r,i={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}const s={id:"02-adding-a-basic-permission-check",title:"2. Adding a basic permission check",description:"Explains how to add a basic permission check to a Backstage plugin"},a=void 0,l={unversionedId:"permissions/plugin-authors/02-adding-a-basic-permission-check",id:"permissions/plugin-authors/02-adding-a-basic-permission-check",title:"2. Adding a basic permission check",description:"Explains how to add a basic permission check to a Backstage plugin",source:"@site/../docs/permissions/plugin-authors/02-adding-a-basic-permission-check.md",sourceDirName:"permissions/plugin-authors",slug:"/permissions/plugin-authors/02-adding-a-basic-permission-check",permalink:"/docs/permissions/plugin-authors/02-adding-a-basic-permission-check",draft:!1,editUrl:"https://github.com/backstage/backstage/edit/master/docs/../docs/permissions/plugin-authors/02-adding-a-basic-permission-check.md",tags:[],version:"current",sidebarPosition:2,frontMatter:{id:"02-adding-a-basic-permission-check",title:"2. Adding a basic permission check",description:"Explains how to add a basic permission check to a Backstage plugin"},sidebar:"docs",previous:{title:"1. Tutorial setup",permalink:"/docs/permissions/plugin-authors/01-setup"},next:{title:"3. Adding a resource permission check",permalink:"/docs/permissions/plugin-authors/03-adding-a-resource-permission-check"}},c={},p=[{value:"Creating a new permission",id:"creating-a-new-permission",level:2},{value:"Authorizing using the new permission",id:"authorizing-using-the-new-permission",level:2},{value:"Test the authorized create endpoint",id:"test-the-authorized-create-endpoint",level:2}],u={toc:p};function d(e){var{components:t}=e,n=o(e,["components"]);return(0,r.kt)("wrapper",i({},u,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("p",null,"If the outcome of a permission check doesn't need to change for different ",(0,r.kt)("a",i({parentName:"p"},{href:"/docs/permissions/concepts#resources-and-rules"}),"resources"),", you can use a ",(0,r.kt)("em",{parentName:"p"},"basic permission check"),". For this kind of check, we simply need to define a ",(0,r.kt)("a",i({parentName:"p"},{href:"/docs/permissions/concepts#resources-and-rules"}),"permission"),", and call ",(0,r.kt)("inlineCode",{parentName:"p"},"authorize")," with it."),(0,r.kt)("p",null,"For this tutorial, we'll use a basic permission check to authorize the ",(0,r.kt)("inlineCode",{parentName:"p"},"create")," endpoint in our todo-backend. This will allow Backstage integrators to control whether each of their users is authorized to create todos by adjusting their ",(0,r.kt)("a",i({parentName:"p"},{href:"/docs/permissions/concepts#policy"}),"permission policy"),"."),(0,r.kt)("p",null,"We'll start by creating a new permission, and then we'll use the permission api to call ",(0,r.kt)("inlineCode",{parentName:"p"},"authorize")," with it during todo creation."),(0,r.kt)("h2",i({},{id:"creating-a-new-permission"}),"Creating a new permission"),(0,r.kt)("p",null,"Let's navigate to the file ",(0,r.kt)("inlineCode",{parentName:"p"},"plugins/todo-list-common/src/permissions.ts")," and add our first permission:"),(0,r.kt)("pre",null,(0,r.kt)("code",i({parentName:"pre"},{className:"language-ts",metastring:'title="plugins/todo-list-common/src/permissions.ts"',title:'"plugins/todo-list-common/src/permissions.ts"'}),"import { createPermission } from '@backstage/plugin-permission-common';\n\n/* highlight-remove-start */\nexport const tempExamplePermission = createPermission({\n  name: 'temp.example.noop',\n  attributes: {},\n/* highlight-remove-end */\n/* highlight-add-start */\nexport const todoListCreatePermission = createPermission({\n  name: 'todo.list.create',\n  attributes: { action: 'create' },\n/* highlight-add-end */\n});\n\n/* highlight-remove-next-line */\nexport const todoListPermissions = [tempExamplePermission];\n/* highlight-add-next-line */\nexport const todoListPermissions = [todoListCreatePermission];\n")),(0,r.kt)("p",null,"For this tutorial, we've automatically exported all permissions from this file (see ",(0,r.kt)("inlineCode",{parentName:"p"},"plugins/todo-list-common/src/index.ts"),")."),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"Note: We use a separate ",(0,r.kt)("inlineCode",{parentName:"p"},"todo-list-common")," package since all permissions authorized by your plugin should be exported from a ",(0,r.kt)("a",i({parentName:"p"},{href:"https://backstage.io/docs/local-dev/cli-build-system#package-roles"}),'"common-library" package'),". This allows Backstage integrators to reference them in frontend components and permission policies.")),(0,r.kt)("h2",i({},{id:"authorizing-using-the-new-permission"}),"Authorizing using the new permission"),(0,r.kt)("p",null,"Install the following module:"),(0,r.kt)("pre",null,(0,r.kt)("code",i({parentName:"pre"},{}),"$ yarn workspace @internal/plugin-todo-list-backend \\\n  add @backstage/plugin-permission-common @internal/plugin-todo-list-common\n")),(0,r.kt)("p",null,"Edit ",(0,r.kt)("inlineCode",{parentName:"p"},"plugins/todo-list-backend/src/service/router.ts"),":"),(0,r.kt)("pre",null,(0,r.kt)("code",i({parentName:"pre"},{className:"language-ts",metastring:'title="plugins/todo-list-backend/src/service/router.ts"',title:'"plugins/todo-list-backend/src/service/router.ts"'}),"/* highlight-remove-start */\nimport { InputError } from '@backstage/errors';\nimport { IdentityApi } from '@backstage/plugin-auth-node';\n/* highlight-remove-end */\n/* highlight-add-start */\nimport { InputError, NotAllowedError } from '@backstage/errors';\nimport { getBearerTokenFromAuthorizationHeader, IdentityApi } from '@backstage/plugin-auth-node';\nimport { PermissionEvaluator, AuthorizeResult } from '@backstage/plugin-permission-common';\nimport { todoListCreatePermission } from '@internal/plugin-todo-list-common';\n/* highlight-add-end */\n\nexport interface RouterOptions {\n  logger: Logger;\n  identity: IdentityApi;\n  /* highlight-add-next-line */\n  permissions: PermissionEvaluator;\n}\n\nexport async function createRouter(\n  options: RouterOptions,\n): Promise<express.Router> {\n  /* highlight-remove-next-line */\n  const { logger, identity } = options;\n  /* highlight-add-next-line */\n  const { logger, identity, permissions } = options;\n\n  router.post('/todos', async (req, res) => {\n    let author: string | undefined = undefined;\n\n    const user = await identity.getIdentity({ request: req });\n    author = user?.identity.userEntityRef;\n    /* highlight-add-start */\n    const token = getBearerTokenFromAuthorizationHeader(\n      req.header('authorization'),\n    );\n    const decision = (\n      await permissions.authorize([{ permission: todoListCreatePermission }], {\n      token,\n      })\n    )[0];\n\n    if (decision.result === AuthorizeResult.DENY) {\n      throw new NotAllowedError('Unauthorized');\n    }\n    /* highlight-add-end */\n\n    if (!isTodoCreateRequest(req.body)) {\n      throw new InputError('Invalid payload');\n    }\n\n    const todo = add({ title: req.body.title, author });\n    res.json(todo);\n});\n")),(0,r.kt)("p",null,"Pass the ",(0,r.kt)("inlineCode",{parentName:"p"},"permissions")," object to the plugin in ",(0,r.kt)("inlineCode",{parentName:"p"},"packages/backend/src/plugins/todolist.ts"),":"),(0,r.kt)("pre",null,(0,r.kt)("code",i({parentName:"pre"},{className:"language-ts",metastring:'title="packages/backend/src/plugins/todolist.ts"',title:'"packages/backend/src/plugins/todolist.ts"'}),"import { DefaultIdentityClient } from '@backstage/plugin-auth-node';\nimport { createRouter } from '@internal/plugin-todo-list-backend';\nimport { Router } from 'express';\nimport { PluginEnvironment } from '../types';\n\nexport default async function createPlugin({\n  logger,\n  discovery,\n  /* highlight-add-next-line */\n  permissions,\n}: PluginEnvironment): Promise<Router> {\n  return await createRouter({\n    logger,\n    identity: DefaultIdentityClient.create({\n      discovery,\n      issuer: await discovery.getExternalBaseUrl('auth'),\n    }),\n    /* highlight-add-next-line */\n    permissions,\n  });\n}\n")),(0,r.kt)("p",null,"That's it! Now your plugin is fully configured. Let's try to test the logic by denying the permission."),(0,r.kt)("h2",i({},{id:"test-the-authorized-create-endpoint"}),"Test the authorized create endpoint"),(0,r.kt)("p",null,"Before running this step, please make sure you followed the steps described in ",(0,r.kt)("a",i({parentName:"p"},{href:"/docs/permissions/getting-started"}),"Getting started")," section."),(0,r.kt)("p",null,"In order to test the logic above, the integrators of your backstage instance need to change their permission policy to return ",(0,r.kt)("inlineCode",{parentName:"p"},"DENY")," for our newly-created permission:"),(0,r.kt)("pre",null,(0,r.kt)("code",i({parentName:"pre"},{className:"language-ts",metastring:'title="packages/backend/src/plugins/permission.ts"',title:'"packages/backend/src/plugins/permission.ts"'}),"/* highlight-add-start */\nimport {\n  BackstageIdentityResponse,\n} from '@backstage/plugin-auth-node';\n/* highlight-add-end */\nimport {\n  PermissionPolicy,\n  /* highlight-add-next-line */\n  PolicyQuery,\n} from '@backstage/plugin-permission-node';\n/* highlight-add-start */\nimport { isPermission } from '@backstage/plugin-permission-common';\nimport { todoListCreatePermission } from '@internal/plugin-todo-list-common';\n/* highlight-add-end */\n\nclass TestPermissionPolicy implements PermissionPolicy {\n  /* highlight-remove-next-line */\n  async handle(): Promise<PolicyDecision> {\n  /* highlight-add-start */\n  async handle(\n    request: PolicyQuery,\n    _user?: BackstageIdentityResponse,\n  ): Promise<PolicyDecision> {\n    if (isPermission(request.permission, todoListCreatePermission)) {\n      return {\n        result: AuthorizeResult.DENY,\n      };\n    }\n  /* highlight-add-end */\n\n    return {\n      result: AuthorizeResult.ALLOW,\n    };\n}\n")),(0,r.kt)("p",null,"Now the frontend should show an error whenever you try to create a new Todo item."),(0,r.kt)("p",null,"Let's flip the result back to ",(0,r.kt)("inlineCode",{parentName:"p"},"ALLOW")," before moving on."),(0,r.kt)("pre",null,(0,r.kt)("code",i({parentName:"pre"},{className:"language-ts"}),"if (isPermission(request.permission, todoListCreatePermission)) {\n  return {\n    /* highlight-remove-next-line */\n    result: AuthorizeResult.DENY,\n    /* highlight-add-next-line */\n    result: AuthorizeResult.ALLOW,\n  };\n}\n")),(0,r.kt)("p",null,"At this point everything is working but if you run ",(0,r.kt)("inlineCode",{parentName:"p"},"yarn tsc")," you'll get some errors, let's fix those up."),(0,r.kt)("p",null,"First we'll clean up the ",(0,r.kt)("inlineCode",{parentName:"p"},"plugins/todo-list-backend/src/service/router.test.ts"),":"),(0,r.kt)("pre",null,(0,r.kt)("code",i({parentName:"pre"},{className:"language-ts",metastring:'title="plugins/todo-list-backend/src/service/router.test.ts"',title:'"plugins/todo-list-backend/src/service/router.test.ts"'}),"import { getVoidLogger } from '@backstage/backend-common';\nimport { DefaultIdentityClient } from '@backstage/plugin-auth-node';\n/* highlight-add-next-line */\nimport { PermissionEvaluator } from '@backstage/plugin-permission-common';\nimport express from 'express';\nimport request from 'supertest';\n\nimport { createRouter } from './router';\n\n/* highlight-add-start */\nconst mockedAuthorize: jest.MockedFunction<PermissionEvaluator['authorize']> =\n  jest.fn();\nconst mockedPermissionQuery: jest.MockedFunction<\n  PermissionEvaluator['authorizeConditional']\n> = jest.fn();\n\nconst permissionEvaluator: PermissionEvaluator = {\n  authorize: mockedAuthorize,\n  authorizeConditional: mockedPermissionQuery,\n};\n/* highlight-add-end */\n\ndescribe('createRouter', () => {\n  let app: express.Express;\n\n  beforeAll(async () => {\n    const router = await createRouter({\n      logger: getVoidLogger(),\n      identity: {} as DefaultIdentityClient,\n      /* highlight-add-next-line */\n      permissions: permissionEvaluator,\n    });\n    app = express().use(router);\n  });\n\n  beforeEach(() => {\n    jest.resetAllMocks();\n  });\n\n  describe('GET /health', () => {\n    it('returns ok', async () => {\n      const response = await request(app).get('/health');\n\n      expect(response.status).toEqual(200);\n      expect(response.body).toEqual({ status: 'ok' });\n    });\n  });\n});\n")),(0,r.kt)("p",null,"Then we want to update the ",(0,r.kt)("inlineCode",{parentName:"p"},"plugins/todo-list-backend/src/service/standaloneServer.ts"),", first we need to add the ",(0,r.kt)("inlineCode",{parentName:"p"},"@backstage/plugin-permission-node")," package to ",(0,r.kt)("inlineCode",{parentName:"p"},"plugins/todo-list-backend/package.json")," and then we can make the following edits:"),(0,r.kt)("pre",null,(0,r.kt)("code",i({parentName:"pre"},{className:"language-ts",metastring:'title="plugins/todo-list-backend/src/service/standaloneServer.ts"',title:'"plugins/todo-list-backend/src/service/standaloneServer.ts"'}),"import {\n  createServiceBuilder,\n  loadBackendConfig,\n  SingleHostDiscovery,\n  /* highlight-add-next-line */\n  ServerTokenManager,\n} from '@backstage/backend-common';\nimport { DefaultIdentityClient } from '@backstage/plugin-auth-node';\n/* highlight-add-next-line */\nimport { ServerPermissionClient } from '@backstage/plugin-permission-node';\nimport { Server } from 'http';\nimport { Logger } from 'winston';\nimport { createRouter } from './router';\n\nexport interface ServerOptions {\n  port: number;\n  enableCors: boolean;\n  logger: Logger;\n}\n\nexport async function startStandaloneServer(\n  options: ServerOptions,\n): Promise<Server> {\n  const logger = options.logger.child({ service: 'todo-list-backend' });\n  logger.debug('Starting application server...');\n  const config = await loadBackendConfig({ logger, argv: process.argv });\n  const discovery = SingleHostDiscovery.fromConfig(config);\n  /* highlight-add-start */\n  const tokenManager = ServerTokenManager.fromConfig(config, {\n    logger,\n  });\n  const permissions = ServerPermissionClient.fromConfig(config, {\n    discovery,\n    tokenManager,\n  });\n  /* highlight-add-end */\n  const router = await createRouter({\n    logger,\n    identity: DefaultIdentityClient.create({\n      discovery,\n      issuer: await discovery.getExternalBaseUrl('auth'),\n    }),\n    /* highlight-add-next-line */\n    permissions,\n  });\n\n  let service = createServiceBuilder(module)\n    .setPort(options.port)\n    .addRouter('/todo-list', router);\n  if (options.enableCors) {\n    service = service.enableCors({ origin: 'http://localhost:3000' });\n  }\n\n  return await service.start().catch(err => {\n    logger.error(err);\n    process.exit(1);\n  });\n}\n\nmodule.hot?.accept();\n")),(0,r.kt)("p",null,"Finally, we need to update ",(0,r.kt)("inlineCode",{parentName:"p"},"plugins/todo-list-backend/src/plugin.ts"),":"),(0,r.kt)("pre",null,(0,r.kt)("code",i({parentName:"pre"},{className:"language-ts",metastring:'title="plugins/todo-list-backend/src/plugin.ts"',title:'"plugins/todo-list-backend/src/plugin.ts"'}),"import { loggerToWinstonLogger } from '@backstage/backend-common';\nimport {\n  coreServices,\n  createBackendPlugin,\n} from '@backstage/backend-plugin-api';\nimport { createRouter } from './service/router';\n\n/**\n* The example TODO list backend plugin.\n*\n* @alpha\n*/\nexport const exampleTodoListPlugin = createBackendPlugin({\n  pluginId: 'exampleTodoList',\n  register(env) {\n    env.registerInit({\n      deps: {\n        identity: coreServices.identity,\n        logger: coreServices.logger,\n        httpRouter: coreServices.httpRouter,\n        /* highlight-add-next-line */\n        permissions: coreServices.permissions,\n      },\n      /* highlight-remove-next-line */\n      async init({ identity, logger, httpRouter }) {\n      /* highlight-add-next-line */\n      async init({ identity, logger, httpRouter, permissions }) {\n        httpRouter.use(\n          await createRouter({\n            identity,\n            logger: loggerToWinstonLogger(logger),\n            permissions,\n          }),\n        );\n      },\n    });\n  },\n});\n")),(0,r.kt)("p",null,"Now when you run ",(0,r.kt)("inlineCode",{parentName:"p"},"yarn tsc")," you should have no more errors."))}d.isMDXComponent=!0},862525:e=>{var t=Object.getOwnPropertySymbols,n=Object.prototype.hasOwnProperty,r=Object.prototype.propertyIsEnumerable;function i(e){if(null==e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}e.exports=function(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},n=0;n<10;n++)t["_"+String.fromCharCode(n)]=n;if("0123456789"!==Object.getOwnPropertyNames(t).map((function(e){return t[e]})).join(""))return!1;var r={};return"abcdefghijklmnopqrst".split("").forEach((function(e){r[e]=e})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},r)).join("")}catch(i){return!1}}()?Object.assign:function(e,o){for(var s,a,l=i(e),c=1;c<arguments.length;c++){for(var p in s=Object(arguments[c]))n.call(s,p)&&(l[p]=s[p]);if(t){a=t(s);for(var u=0;u<a.length;u++)r.call(s,a[u])&&(l[a[u]]=s[a[u]])}}return l}},541535:(e,t,n)=>{var r=n(862525),i=60103,o=60106;var s=60109,a=60110,l=60112;var c=60115,p=60116;if("function"==typeof Symbol&&Symbol.for){var u=Symbol.for;i=u("react.element"),o=u("react.portal"),u("react.fragment"),u("react.strict_mode"),u("react.profiler"),s=u("react.provider"),a=u("react.context"),l=u("react.forward_ref"),u("react.suspense"),c=u("react.memo"),p=u("react.lazy")}var d="function"==typeof Symbol&&Symbol.iterator;function g(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var m={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},h={};function f(e,t,n){this.props=e,this.context=t,this.refs=h,this.updater=n||m}function k(){}function y(e,t,n){this.props=e,this.context=t,this.refs=h,this.updater=n||m}f.prototype.isReactComponent={},f.prototype.setState=function(e,t){if("object"!=typeof e&&"function"!=typeof e&&null!=e)throw Error(g(85));this.updater.enqueueSetState(this,e,t,"setState")},f.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},k.prototype=f.prototype;var b=y.prototype=new k;b.constructor=y,r(b,f.prototype),b.isPureReactComponent=!0;var v={current:null},w=Object.prototype.hasOwnProperty,P={key:!0,ref:!0,__self:!0,__source:!0};function x(e,t,n){var r,o={},s=null,a=null;if(null!=t)for(r in void 0!==t.ref&&(a=t.ref),void 0!==t.key&&(s=""+t.key),t)w.call(t,r)&&!P.hasOwnProperty(r)&&(o[r]=t[r]);var l=arguments.length-2;if(1===l)o.children=n;else if(1<l){for(var c=Array(l),p=0;p<l;p++)c[p]=arguments[p+2];o.children=c}if(e&&e.defaultProps)for(r in l=e.defaultProps)void 0===o[r]&&(o[r]=l[r]);return{$$typeof:i,type:e,key:s,ref:a,props:o,_owner:v.current}}function O(e){return"object"==typeof e&&null!==e&&e.$$typeof===i}var j=/\/+/g;function C(e,t){return"object"==typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,(function(e){return t[e]}))}(""+e.key):t.toString(36)}function N(e,t,n,r,s){var a=typeof e;"undefined"!==a&&"boolean"!==a||(e=null);var l=!1;if(null===e)l=!0;else switch(a){case"string":case"number":l=!0;break;case"object":switch(e.$$typeof){case i:case o:l=!0}}if(l)return s=s(l=e),e=""===r?"."+C(l,0):r,Array.isArray(s)?(n="",null!=e&&(n=e.replace(j,"$&/")+"/"),N(s,t,n,"",(function(e){return e}))):null!=s&&(O(s)&&(s=function(e,t){return{$$typeof:i,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(s,n+(!s.key||l&&l.key===s.key?"":(""+s.key).replace(j,"$&/")+"/")+e)),t.push(s)),1;if(l=0,r=""===r?".":r+":",Array.isArray(e))for(var c=0;c<e.length;c++){var p=r+C(a=e[c],c);l+=N(a,t,n,p,s)}else if(p=function(e){return null===e||"object"!=typeof e?null:"function"==typeof(e=d&&e[d]||e["@@iterator"])?e:null}(e),"function"==typeof p)for(e=p.call(e),c=0;!(a=e.next()).done;)l+=N(a=a.value,t,n,p=r+C(a,c++),s);else if("object"===a)throw t=""+e,Error(g(31,"[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t));return l}function E(e,t,n){if(null==e)return e;var r=[],i=0;return N(e,r,"","",(function(e){return t.call(n,e,i++)})),r}function S(e){if(-1===e._status){var t=e._result;t=t(),e._status=0,e._result=t,t.then((function(t){0===e._status&&(t=t.default,e._status=1,e._result=t)}),(function(t){0===e._status&&(e._status=2,e._result=t)}))}if(1===e._status)return e._result;throw e._result}var R={current:null};function A(){var e=R.current;if(null===e)throw Error(g(321));return e}},827378:(e,t,n)=>{n(541535)}}]);